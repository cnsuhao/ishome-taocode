[toc]

## 1 手机端接口说明

>标签：接口\手机端接口

---
###  文档更新说明
> 更新时间：2016-08-02

###  接口调用说明
 > 手机端分为教师查询端及家长查询端，本接口主要为该两部分提供内容，同时兼顾教师后台页面的部分功能。本接口分为三个部分，分别为：新闻管理接口部分，通讯录查询部分（补充后台教师管理部分缺少的功能），以及值日值周查询一个学期（阶段）内，哪些日期有特定老师的值日值周安排和值日值周查每天哪几个老师轮值（好像已经有了）的接口；
 
 > 新闻CMS接口部分的主要功能是实现新闻的展示，特定栏目的展示，特定新闻的查询，以及栏目使用的图片轮播模式；

 > 通讯录部分主要加入了教师查询其任课班级，以及班级查询对应的任课老师，和班级下面的家长列表查询；
 
 > 值日值周部分主要加入按照时间阶段返回那一日有特定教师的值日信息，值周信息。课表部分需要加入类似的按照时间阶段返回那一日有特定教师的上课信息接口。（按天或者按周查询对应的值日和值周安排可以通过工作管理页面的值日值周查询页面完成）；

>幻灯图片上传接口待确认，所以所有牵扯到幻灯图片上传的字段pic相关需要确定2016-8-3


### 1.1 新闻展示接口部分
#### 1.1.1 栏目查询接口
>详见
>2 校园新闻管理
>2.2 新闻栏目管理页面接口
>2.2.1 新闻栏目查询接口

#### 1.1.2 新闻查询接口

> 新闻列表查询接口返回了当前的新闻列表，以时间倒序，显示指定时间内的新闻内容列表供管理员查看（注意：栏目设置为暂停的栏目下的新闻不可见，接口关联查询要加上），需要根据token中的角色教师tid或学生家长id获取可查看新闻列表（需要到新闻表中对比新闻可读范围比对）
> 返回所有有效的新闻栏目，所有新闻均为已审核通过新闻；
> 需要使用Token验证查询者身份
``` json
Url:        /qxy/newlist?columnId=[columnId]&page=[page]&size=[size]&token=[token]
Method:     GET
Header:     Content-type:application/json
Parameter:
    - 'columnId': 指定搜索的栏目ID，无column参数或参数无效时返回全部数据
    - `page`:   分页编号，分页为0或者空时，返回全部数据
    - `size`:   每页数据条数，为0或空时，默认返回12条数据
    - `token` ：      token
Response:
    - `status`：0->成功
                1->无效的栏目id
                11->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use interface
    - 'newslist':    新闻数据json
    - 'count':       当前返回新闻数据条数
    - 'page':        当前页数
    - 'size':        每页显示条数
```

> **返回结果示例：**

``` json
{
    "status": 0,
    "data": {
        "page":"2",
        "size":"12",
        "count":"20",
        "newslist":[
            {
                "newsId": "122",
                "title": "学校建设迈入新阶段",
                "isTop": "1",                #是不是置顶0-非置顶；1-置顶
                "isPic": "1",                #是不是包括图片0-不包括；1-包括
                "pic": "url",                 
                "isHomenews":"0",            #是否为首页轮播0-否，1-是
                "authorName": "张俪",         #作者名（对应teacherName）
                "publishTime": "2016-8-9 00:00:00",   #发布时间
                "columnId":"1",                      #栏目id 
                "columnName":"校园风采",              #栏目名称
            },
            {
                "newsId": "123",
                "title": "学校建设迈入新阶段",
                "isTop": "1",                #是不是置顶0-非置顶；1-置顶
                "isPic": "1",                #是不是包括图片0-不包括；1-包括
                "pic": "url",                
                "isHomenews":"0",            #是否为首页轮播0-否，1-是
                "authorName": "张俪",         #作者名（对应teacherName）
                "publishTime": "2016-8-9 00:00:00",   #发布时间
                "columnId":"1",                      #栏目id 
                "columnName":"校园风采",              #栏目名称
            }
        ]
    }
}
```
#### 1.1.3 新闻内容查询接口
>2 校园新闻页面接口说明
>2.1 新闻管理页面接口
>2.1.2 新闻详情查看接口

#### 1.1.4 轮播新闻查询接口
>需要token验证
``` json
Url:        /qxy/homenews/list?token=[token]
Method:     GET
Header:     Content-type:application/json
Parameter:
    - `token` ：      token
Response:
    - `status`：0->成功
                1->无效的栏目id
                11->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use interface
    - 'homenews':    轮播新闻数据json
    - 'count':       当前返回新闻数据条数
    - 'newsId':     全部提交的新闻数据条数
    - 'title':       新闻标题
    - 'pic':         轮播图
```

> **返回结果示例：**

``` json
{
    "status": 0,
    "data": {
        "count":"2",
        "homenews":[
            {
                "newsId": "122",
                "title": "学校建设迈入新阶段",
                "pic":"url"
            },
            {

                "newsId": "123",
                "title": "学校建设迈入新阶段sss",
                "pic":"url"
            }
        ]
    }
}
```
### 1.2 通讯录部分
#### 1.2.1 教师查询任课班级
>需要token验证

``` json
Url:        /qxy/teacher/class?termId=[termId]&tid=[tid]&token=[token]
Method:     GET
Header:     Content-type:application/json
Parameter:
    - `termId`:      学期id   不填则默认为当前学期
    - `tid`:   教师id   不填则为所有教师
Response:
    - `status`：0->is OK
                1->失败，无调用权力打开id内容
               11->token is invalid
               12->token is timeout
               13->Illegal interface calls, not power use interface
    - `count`:        返回的教师数量
    - `teacherlist`:  教师json
    - `classlist`:    班级json
```

> **返回结果示例：**

``` json
{
    "status": 0,
    "data":{
	    "count":"2",
	    "tid":"12",
	    "teacherName":"张老师",
	    "isLeader":"1",       #是否为班主任 0-否，1-是
	    "classlist":[
		    {
			    "cid":"123",
			    "termName":"2016-2017-1",
			    "graderName":"高一",
			    "className":"一班"
		    }，
		    {
			    "cid":"123",
			    "termName":"2016-2017-1",
			    "graderName":"高一",
			    "className":"一班"
		    }
	    ]
    }
}
```

#### 1.2.2 班级查询任课老师
>需要token验证

``` json
Url:        /qxy/class/teacher?termId=[term]&cid=[cid]&token=[token]
Method:     GET
Header:     Content-type:application/json
Parameter:
    - `termId`:      学期id   不填则默认为当前学期
    - `cid`:     班级id   不填则为所有班级
    - `token` ：      token
Response:
    - `status`：0->is OK
                1->失败，无调用权力打开id内容
               11->token is invalid
               12->token is timeout
               13->Illegal interface calls, not power use interface
    - `count`:        返回的班级数量
    - `teacherlist`:  教师json
    - `classlist`:    班级json
```

> **返回结果示例：**

``` json
{
    "status": 0,
    "data":{
	    "cid":"12",
	    "termName":"2016-2017-1",
	    "graderName":"高一",
	    "className":"一班",
	    "count":"2",
	    "teacherlist":[
		    {
			    "tid":"123",
			    "teacherName":"张老师",
			    "courseId":"12",
			    "courseName":"语文",
			    "isLeader":"1"       #是否为班主任 0-否，1-是
		    }，
		    {

			    "tid":"123",
			    "teacherName":"张老师",
			    "courseId":"12",
			    "courseName":"语文",
			    "isLeader":"1"       #是否为班主任 0-否，1-是
		    }
	    ]
    }
}
```


#### 1.2.3 班级查询家长通讯录
> 班级学生查询接口返回当时学期的特定班级的家长数据，班级学生家长页面接口支持分页，支持根据学生名条件查询

> 班级查询家长接口需要使用Token验证查询者身份

``` json
Url:        /qxy/class/parent?termId=[term]&cid=[cid]&studentId=[studentId]&page=[page]&size=[size]&token=[token]
Method:     GET
Header:     Content-type:application/json
Parameter:
    - `termId`:   查询的学期id
    - `cid`:  查询的班级cid
    - `studentId`:   学生id
    - `page`:   分页编号，分页为0或者空时，返回全部数据
    - `size`:   每页数据条数，为0或空时，默认返回12条数据
    - `token` ：      token
Response:
    - `status`：0->token is OK 
                11->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use interface
    - `parents`:       家长内容JSON
    - `count`:         家长总数
    - `role`:          角色：1-爸爸;2-妈妈;3-爷爷;4-奶奶;5-其他
    - `workUnit`:     工作单位
    - `position`:      职位
    - `isDefault`:    是否缺省家长，0-否；1-是
```

> **返回结果示例：**

``` json
{
    "status": 0,
    "data":{
        "cid":"12",
	    "termName":"2016-2017-1",
	    "graderName":"高一",
	    "className":"一班",
        "page":"2",
        "size":"21",
        "count":"45",
        "parents":[
            {   
                "parentId":"12",
                "parentName":"张三三",
                "role":"1",    #角色：1-爸爸;2-妈妈;3-爷爷;4-奶奶;5-其他
                "studentId":"3434",
                "studentName":"张高丽",
                "phone":"13434567890",
                "workUnit":"南水北调",    #工作单位
                "position":"工程师",       #职位
                "isDefault":"0"   #是否缺省家长，0-否；1-是
            },
            {   
                "parentId":"12",
                "parentName":"张三三",
                "role":"1",    #1-爸爸;2-妈妈;3-爷爷;4-奶奶;5-其他
                "studentId":"3434",
                "studentName":"张高丽",
                "phone":"13434567890",
                "workUnit":"南水北调",
                "position":"工程师",
                "isDefault":"0"   #是否缺省家长，0-否；1-是
            },
            {   
                "parentId":"12",
                "parentName":"张三三",
                "role":"1",    #1-爸爸;2-妈妈;3-爷爷;4-奶奶;5-其他
                "studentId":"3434",
                "studentName":"张高丽",
                "phone":"13434567890",
                "workUnit":"南水北调",
                "position":"工程师",
                "isDefault":"0"   #是否缺省家长，0-否；1-是
            }
        ]
    }
}
```
#### 1.2.3-1 班级学生查询家长详细信息

>需要使用Token验证查询者身份

``` json
Url:        /qxy/class/parent/info?parentId=[parentId]&token=[token]
Method:     GET
Header:     Content-type:application/json
Parameter:
    - `parentId`:     家长id
    - `token` ：      token
Response:
    - `status`：0->token is OK 
                11->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use interface
    - `parents`:       家长内容JSON
    - `count`:         家长总数
    - `role`:          角色：1-爸爸;2-妈妈;3-爷爷;4-奶奶;5-其他
    - `workUnit`:      工作单位
    - `position`:      职位
    - `isDefault`:    是否缺省家长，0-否；1-是
```

> **返回结果示例：**

``` json
{
    "status": 0,
    "data":{
        "parentId":"12",
		"parentName":"张三三",
		"role":"1",    #角色：1-爸爸;2-妈妈;3-爷爷;4-奶奶;5-其他
		"phone":"13434567890",
		"email":"13434@qq.com",
		"workUnit":"南水北调",     #工作单位
		"position":"工程师",        #职位
		"studentinfo":[
			{
				"studentId":"3434",
				"studentName":"张高丽",
				"isDefault":"0"            #是否该学生的缺省家长，0-否；1-是				
			}，
			{
				"studentId":"3434",
				"studentName":"张高丽",
				"isDefault":"0"            #是否该学生的缺省家长，0-否；1-是				
			}
		]	
    }
}
```

#### 1.2.4 家长角色对应学生所属班
> 家长查询对应学生所属班级
> 需要使用Token验证查询者身份

``` json
Url:        /qxy/parent/class?termId=[term]&parentId=[parentId]&studentId=[studentId]&token=[token]
Method:     GET
Header:     Content-type:application/json
Parameter:
    - `termId`:   查询的学期id      不填则为默认学期
    - `parentId`:  查询的家长id
    - `studentId`:   学生id
    - `token` ：      token
Response:
    - `status`：0->token is OK 
                11->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use interface
    - `classlist`:       班级内容JSON
    - `count`:           班级总数
```

> **返回结果示例：**

``` json
{
    "status": 0,
    "data":{
	    "termName":"2016-2017-2",
	    "parentName":"张三丰",
        "studentlist":[
            {   
                "studentId":"12",
                "studentName":"大儿子",
                "cid":"12",
                "gradeName":"初三",
                "className":"三班"
            },
            {   
                "studentId":"12",
                "studentName":"二儿子",
                "cid":"12",
                "gradeName":"初三",
                "className":"三班"
            },
            {   
                "studentId":"12",
                "studentName":"三儿子",
                "cid":"12",
                "gradeName":"初三",
                "className":"三班"
            }
        ]
    }
}
```

### 1.3 值日值周接口部分
#### 1.3.1 值日值周信息日历表状态查询接口
引用工作管理-值日值周中值日值周信息日历表状态查询接口
>3 工作管理页面接口说明
>3.1 值日值周页面接口
>3.1.1 值日值周信息日历表状态查询接口
#### 1.3.2 值周工作安排查询接口
>需要使用Token验证查询者身份

> 值周工作安排查询接口用于手机端和后台首页查询指定学期中每周设置了那些值周数据，本接口调用时需要传入学期和周参数，返回的是本周值周工作列表，值周内容条数有限，不考虑分页功能
> 需要使用Token验证查询者身份

``` json
Url:        /qxy/schedule/mobile/week?termId=[termId]&week=[week]&tid=[tid]&token=[token]
Method:     GET
Header:     Content-type:application/json
Parameter:
    - `termId`:        指定查询的学期id，term为空时查询缺省的学期
    - `week`:        指定该学期的对应周，当数据为空时，选择当前日期所在的周
    - `tid`:     指定教师id，当数据为空时默认获取token中包含tid的值周数据
    - `token` ：      token
Response:
    - `status`:      0->OK 
					 1->获取失败，查找的周不存在
                     10->token is invalid
                     12->token is timeout
                     13->Illegal interface calls, not power use interface
    - `scheduleweek`:        值周数据内容JSON
    - `count`:               值周数据内容的条目总数
    - `scheduleId`:          岗位人员排班表对应id
    - `dutyId`:              岗位id
    - `dutyName`:            岗位名字
    - `content`:             岗位职责内容
    - `startTime`:           岗位职责开始时间
    - `endTime`:             岗位职责结束时间
```

> **返回结果示例：**

``` json
{
    "status": 0,
    "data":{
        "count":"2",
        "week":"2",
        "startTime":"2016-8-9 00:00:00",
        "endTime":"2016-8-9 00:00:00",
        "scheduleweek":[
            {
	            "scheduleId":"1",                #岗位人员排班表对应id
				"dutyId":"221",                  #值周岗位id
                "dutyName":"大门查询岗位",       #岗位名称
				"id":"22",                       #岗位职责id
                "content": "学校安全检查",       #岗位职责内容
                "startTime":"07:00",             #岗位职责开始时间
                "endTime":"08:00"                #岗位职责结束时间
            },
            {
	            "scheduleId":"1",                #岗位人员排班表对应id
				"dutyId":"221",                  #值周岗位id
                "dutyName":"大门查询岗位",       #岗位名称
				"id":"22",                       #岗位职责id
                "content": "学校安全检查",       #岗位职责内容
                "startTime":"07:00",             #岗位职责开始时间
                "endTime":"08:00"                #岗位职责结束时间
            }
        ]
    }
}
```


#### 1.3.3 值日工作安排查询接口
>需要使用Token验证查询者身份

> 值日工作安排查询接口用于手机端和后台首页查询指定学期中某天设置了那些值日数据，本接口调用时需要传入学期和日参数，返回的是本日值日工作列表，值日内容条数有限，不考虑分页功能
> 需要使用Token验证查询者身份

``` json
Url:        /qxy/schedule/mobile/day?termId=[termId]&date=[date]&tid=[tid]&token=[token]
Method:     GET
Header:     Content-type:application/json
Parameter:
    - `termId`:        指定查询的学期id，term为空时查询缺省的学期
    - `date`:         指定该学期的日期，当数据为空时，选择当前日期
    - `tid`:     指定教师id，当数据为空时默认获取token中包含tid的值日数据
Response:
    - `status`:      0->OK 
					 1->获取失败，查找的日不存在
                     10->token is invalid
                     12->token is timeout
                     13->Illegal interface calls, not power use interface
    - `scheduleday`:         值日数据内容JSON
    - `count`:               值周数据内容的条目总数
    - `scheduleId`:          岗位人员排班表对应id
    - `dutyId`:              岗位id
    - `dutyName`:            岗位名字
    - `content`:             岗位职责内容
    - `startTime`:           岗位职责开始时间
    - `endTime`:             岗位职责结束时间
```

> **返回结果示例：**

``` json
{
    "status": 0,
    "data":{
        "count":"2",
        "date":"1475256252",
        "scheduleday":[
            {
	            "scheduleId":"1",                #岗位人员排班表对应id
				"dutyId":"221",                  #值周岗位id
                "dutyName":"大门查询岗位",       #岗位名称
				"id":"22",                       #岗位职责id
                "content": "学校安全检查",       #岗位职责内容
                "startTime":"07:00",             #岗位职责开始时间
                "endTime":"08:00"                #岗位职责结束时间
            },
            {
	            "scheduleId":"1",                #岗位人员排班表对应id
				"dutyId":"221",                  #值周岗位id
                "dutyName":"大门查询岗位",       #岗位名称
				"id":"22",                       #岗位职责id
                "content": "学校安全检查",       #岗位职责内容
                "startTime":"07:00",             #岗位职责开始时间
                "endTime":"08:00"                #岗位职责结束时间
            }
        ]
    }
}
```

