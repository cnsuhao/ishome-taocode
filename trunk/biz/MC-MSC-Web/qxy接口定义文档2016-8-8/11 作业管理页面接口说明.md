## 11 作业管理
@(交接)

> 标签： 接口 系统设置

---

### 文档更新说明
> 更新时间：2016-09-22
> 作者：熊雁明

### 页面说明
>作业管理功能包括以下页面：作业列表查询、作业搜索、作业新增、详情查看、作业置顶、作业删除等。

>声明开发测试时前端需要在url上加上test=true参数，标示为测试接口，接口会返回静态数据以提供给前端调试页面使用，前端需要使用测试接口完成数据渲染工作后，等到正式接口开发完成后，才能调用正式接口；

###11.1 作业管理
####11.1.1-1  作业班级作业列表查询接口
> 作业列表查询， 该接口应用在手机端或查询班级作业的场景下；在管理平台上需要应用11.1.1-2接口获取某个教师自己布置的作业
> 需要使用Token验证查询者身份


``` json
Url:        /qxy/task/class?cid=[cid]&page=[page]&size=[size]&token=[token]
Method:     GET
Header:     Content-type:application/json
Parameter:
    - `cid`: 班级id  --必填项
    - `page` 不传默认为1
    - `size` 不传默认为12
    - `token` ：      token
Response:
    - `status`：0->OK 
                11->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use interface
    -  `count`:数据总数
    -  'page': 当前页数，不传或等于0  默认等于1
    -  'size': 每页显示数据量，不传或为0时一页返回12条数据
    -  'className': 班级名
    -  'termName': 学期名
    -  'studentCount': 班级人数
    -  'tasklist':作业列表
    -  'taskId': 作业id
    -  `taskName`: 作业标题
    -  `isTop`:是否置顶  0 不置顶 1置顶
    -  `author`:发布人
    -  'courseId':课程栏目id
    -  `courseName`: 作业栏目
    -  `publishTime`:作业发布时间
```
> **返回结果示例：**

``` json
{
    "status": 0,
    "data": {
        "count":"3",
        "page":"3",
        "size":"12",
        "className": "小学一年级5班",
        "termName": "2016-2017-2",
        "studentCount": 1,
        "tasklist": [
            {
                "taskId":"1",
                "taskName": "写一篇500论点描述",
                "isTop":"0",
                "author":"30",
                "authorName":"吴老师",
                "courseId": "2",
                "courseName": "语文",
                "publishTime":"2019-09-22 16:20:30"
            },
            {
                "taskId":"2",
                "taskName": "写一篇500论点描述2",
                "isTop":"0",
                "author":"30",
                "authorName":"吴老师",
                "courseId": "1",
                "courseName": "语文",
                "publishTime":"2019-09-22 16:20:30"
            },
            {
                "taskId":"3",
                "taskName": "写一篇500论点描述3",
                "isTop":"0",
                "author":"30",
                "authorName":"吴老师",
                "courseId": "2",
                "courseName": "语文",
                "publishTime":"2019-09-22 16:20:30"
            }
        ]
    }
}
```
####11.1.1-2  作业教师布置作业列表查询接口
> 该接口主要用于后台管理，用于查询和修改、新增或删除某个教师布置给某个班级的作业，需要同时传tid和cid；

> 需要使用Token验证查询者身份


``` json
Url:        /qxy/task/teacher?cid=[cid]&tid=[tid]&page=[page]&size=[size]&token=[token]
Method:     GET
Header:     Content-type:application/json
Parameter:
    - 'cid'：   班级id  --必填项
    - `tid`:教师id   --必填项
    - `page` 不传默认为1
    - `size` 不传默认为12
    - `token` ：      token
Response:
    - `status`：0->OK 
                11->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use interface
    -  `count`:数据总数
    -  'page': 当前页数，不传或等于0  默认等于1
    -  'size': 每页显示数据量，不传或为0时一页返回12条数据
    -  'tasklist':作业列表
    -  'taskId': 作业id
    -  `taskName`: 作业标题
    -  `isTop`:是否置顶  0 不置顶 1置顶
    -  `author`:发布人id
    -  `authorName`:发布人
    -  'courseId':课程栏目id
    -  `courseName`: 作业栏目
    -  `publishTime`:作业发布时间
```
> **返回结果示例：**

``` json
{
    "status": 0,
    "data": {
        "count":"3",
        "page":"3",
        "size":"12",
        "tasklist": [
            {
                "taskId":"1",
                "taskName": "写一篇500论点描述",
                "isTop":"0",
                "author":"30",
                "authorName":"吴老师",
                "courseId": "2",
                "courseName": "语文",
                "publishTime":"2019-09-22 16:20:30"
            },
            {
                "taskId":"2",
                "taskName": "写一篇500论点描述2",
                "isTop":"0",
                "author":"30",
                "authorName":"吴老师",
                "courseId": "1",
                "courseName": "语文",
                "publishTime":"2019-09-22 16:20:30"
            },
            {
                "taskId":"3",
                "taskName": "写一篇500论点描述3",
                "isTop":"0",
                "author":"30",
                "authorName":"吴老师",
                "courseId": "2",
                "courseName": "语文",
                "publishTime":"2019-09-22 16:20:30"
            }
        ]
    }
}
```
####11.1.1-3  教师班级学期年级列表查询接口
>用于查询某个教师的所有学期年级班级信息，不传tid或者=0则获取token中教师的相关学期年级班级，如果传tid则获取相应tid的学期年级班级信息；
>默认需要返回所有有效的信息;
> 需要使用Token验证查询者身份
``` json
Url:        /qxy/termgradeclass/teacher?tid=[tid]&token=[token]
Method:     GET
Header:     Content-type:application/json
Parameter:
        - 'tid':    教师tid，不传或为0时获取token中tid相关学期年级班级信息，如果传tid则获取相应tid学期年级班级信息
Response:
        - `status`:           0->OK 
                              10->token is invalid
                              12->token is timeout
                              13->Illegal interface calls, not power use interface
        - `term`:              学期内容JSON
        - `grade`:             年级内容JSON
        - `class`:             班级内容JSON
        - `count`:             学期总数
        - `isDefault`:        #0-可查看学期；1-缺省设置学期
        - `isUse`:            #是否启用0-停用；1-正常
```

> **返回结果示例：**

``` json
{
    "status": 0,
    "data":{
        "count":"2",
        "tid":"2",
        "teacherName":"张老师",
        "term": [
            {
                "termId":"1",
                "termName": "2016-2017-1",
                "isDefault":"1",          #0-可查看学期；1-缺省学期
                "grade":[
					{
						"gradeId":"1",
						"gradeName"："高一"，
						"isUse":"1",              #0-停用；1-正常	
						"class":[
							{
								"cid":"1",
								"className":"一班"
							}，
							{
								"cid":"2",
								"className":"二班"
							}
						]
					}，
					{
						"gradeId":"1",
						"gradeName"："高一"，
						"isUse":"1",              #0-停用；1-正常	
						"class":[
							{
								"cid":"1",
								"className":"一班"
							}，
							{
								"cid":"2",
								"className":"二班"
							}
						]
					}
				]
            },
            {
                "termId":"1",
                "termName": "2016-2017-1",
                "isDefault":"0",  
                "isUse":"1",
                "grade":[
					{
						"gradeId":"1",
						"gradeName"："高一"，
						"isUse":"1",              #0-停用；1-正常		
						"class":[
							{
								"cid":"1",
								"className":"一班"
							}，
							{
								"cid":"2",
								"className":"二班"
							}
						]
					}
				]
            }
        ]
    }
}
```

####11.1.2 作业详情查看接口
>作业详情查看，需要输入taskId

> 需要使用Token验证查询者身份

``` json
Url:        /qxy/task/info?taskId=[taskId]&token=[token]
Method:     GET
Header:     Content-type:application/json
Parameter:
    - `taskId`:    作业id --必填项
    - `token` ：      token
Response:
    - `status`：0->OK 
                11->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use interface
    -  `taskId`: 作业id
    -  `taskName`: 作业标题
    -  'content' :  作业说明
    -  `video`： 作业音频
    -  `pic`： 作业图片数组
    -  `courseName`: 作业栏目
    -  `content` 作业内容
    -  `taskClasser` 作业发布的班级id数组
    -  `taskClasserName` 作业发布的班级数组
    -  `author`:发布人id
    -  `authorName`:发布人
    -  `publishTime`:作业发布时间
    -  `startTime`:作业开始时间
    -  `endTime`:作业结束时间
    -  'isTop':是否置顶
```
> **返回结果示例：**

``` json
{
    "status": 0,
    "data": {
        "taskId": "1",
        "taskName": "写一篇500论点描述",
        "content": "论秦始皇功大于过.....",
        "video": "url",
        "pic": "url1;url2",
        "courseId": "1",
        "courseName": "语文",
        "taskClasser":"13;15;16",
        "taskClasserName":"2016-2017-2初三1班;2016-2017-2初三3班;2016-2017-2初三5班",
        "author":"30",
        "authorName":"吴老师",
        "publishTime":"2019-09-22 16:20:30",
        "startTime":"2019-09-22 16:20:30",
        "endTime":"2019-09-22 16:20:30",
        "isTop": "1"
    }
}
```
####11.1.3  作业（按名称）搜索接口
> 作业搜索接口，需要输入courseId、taskName，参数为可选，cid为必填参数，tid为可选参数；
> 当仅填写cid时获取该班级下全部教师的作业，如果填写tid时获取该班级下某个教师布置的作业；

> 需要使用Token验证查询者身份

``` json
Url:        /qxy/task/search?cid=[cid]&tid=[tid]&courseId=[courseId]&taskName=[taskName]&page=[page]&size=[size]&token=[token]
Method:     GET
Header:     Content-type:application/json
Parameter:
    - 'cid'：        班级id   --必填项
    - `tid`:         教师id   --可选参数
    - 'courseId'：   作业栏目 
    - `taskName`:    作业标题
    - 'page'：       分页参数，不传或为0时返回第一页 
    - `size`:        每页显示数据量，不传或为0时一页返回12条数据
Response:
    - `status`：0->OK 
                1->token is invalid
                2->token is timeout
                3->Illegal interface calls, not power use interface
    -  `count`:数据总数
    -  'page': 当前页数，不传或等于0  默认等于1
    -  'size': 每页显示数据量，不传或为0时一页返回12条数据
    -  'tasklist':作业列表
    -  'taskId': 作业id
    -  `taskName`: 作业标题
    -  `isTop`:是否置顶  0 不置顶 1置顶
    -  `author`:发布人id
    -  `authorName`:发布人
    -  'courseId':课程栏目id
    -  `courseName`: 作业栏目
    -  `publishTime`:作业发布时间
```
> **返回结果示例：**

``` json
{
    "status": 0,
    "data": {
        "count":"3",
        "page":"3",
        "size":"3",
        "count":"15",
        "tasklist": [
            {
                "taskId":"1",
                "taskName": "写一篇500论点描述",
                "isTop":"0",
                "author":"30",
                "authorName":"吴老师",
                "courseId": "2",
                "courseName": "语文",
                "publishTime":"2019-09-22 16:20:30"
            },
            {
                "taskId":"2",
                "taskName": "写一篇500论点描述2",
                "isTop":"0",
                "author":"30",
                "authorName":"吴老师",
                "courseId": "1",
                "courseName": "语文",
                "publishTime":"2019-09-22 16:20:30"
            },
            {
                "taskId":"3",
                "taskName": "写一篇500论点描述3",
                "isTop":"0",
                "author":"30",
                "authorName":"吴老师",
                "courseId": "2",
                "courseName": "语文",
                "publishTime":"2019-09-22 16:20:30"
            }
        ]
    }
}
```
####11.1.4  作业新增接口
>作业新增，需要输入作业对象
>新增作业时需要接口获取token中用户的sid并写入作业表
> 需要使用Token验证查询者身份
``` json
Url:        /qxy/task?token=[token]
Method:     POST
Header:     Content-type:application/json
Parameter:
   -  `taskName`: 作业标题
    -  'content' :  作业说明
    -  `video`： 作业音频
    -  `pic`： 作业图片数组
    -  `courseName`: 作业栏目
    -  `content` 作业内容
    -  `author`:发布人id
    -  `authorName`:发布人
    -  `publishTime`:作业发布时间 ，不传就默认当前时间（app端）
    -  `startTime`:作业开始时间
    -  `endTime`:作业结束时间
    -  'isTop':是否置顶，不传就默认0（app端）
示例：
 {
        "taskName": "写一篇500论点描述",
        "content": "论秦始皇功大于过.....",
        "video": "url",
        "pic": "url1;url2;",
        "courseId": "1",
        "taskClasser":"13;15;16;",
        "author":"30",
        "publishTime":"2019-09-22 16:20:30",
        "startTime":"2019-09-22 16:20:30",
        "endTime":"2019-09-22 16:20:30",
        "isTop": "1"
}
Response:
    - `status`: 0->OK
                1-> 新增失败
                10->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use interface
```

> **返回结果示例：**

``` json
{
    "status": "0",
    "data":{
        "info":"ok"
    }
}
```

####11.1.5  作业置顶/取消接口
> 作业置顶，需要输入taskId、isTop为1时置顶，isTop为0时取消置顶

> 需要使用Token验证查询者身份

``` json
Url:        /qxy/task/set?token=[token]
Method:     PUT
Header:     Content-type:application/json
Parameter:
    -  `taskId`: 作业id数组
    -  `isTop` :isTop为1时置顶，isTop为0时取消置顶
  
示例：
{
    "taskId": "1",
    "isTop" :"1"
}
Response:
    - `status`: 0->is OK 
                10->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use interface
```

> **返回结果示例：**

``` json
{
    "status": "0",
    "data":{
        "info":"ok"
    }
}
```

####11.1.6  作业修改接口
> 作业列表修改，需要输入taskid、修改的内容

> 需要使用Token验证查询者身份

``` json
Url:        /qxy/task?token=[token]
Method:     PUT
Header:     Content-type:application/json
Parameter:
    -  `taskId`: 作业id
    -  `taskName`: 作业标题
    -  'content' :  作业说明
    -  `video`： 作业音频
    -  `pic`： 作业图片数组
    -  `courseName`: 作业栏目
    -  `content` 作业内容
    -  `author`:发布人id
    -  `authorName`:发布人
    -  `publishTime`:作业发布时间
    -  `startTime`:作业开始时间
    -  `endTime`:作业结束时间
    -  'isTop':是否置顶
示例：
{
    "taskId": "1",
    "taskName": "写一篇500论点描述",
    "content": "论秦始皇功大于过.....",
    "video": "url",
    "pic":"url1;url2",
    "courseId": "1",
    "courseName": "语文",
    "taskClasser":"13,15,16",
    "author":"30",
    "publishTime":"2019-09-22 16:20:30",
    "startTime":"2019-09-22 16:20:30",
    "endTime":"2019-09-22 16:20:30",
    "isTop": "1"    
}
Response:
    - `status`: 0->is OK 
                10->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use interface
```

> **返回结果示例：**

``` json
{
    "status": "0",
    "data":{
        "info":"ok"
    }
}
```
####11.1.7  作业删除接口
>作业删除，需要输入taskId

> 需要使用Token验证查询者身份

``` json
Url:        /qxy/task?token=[token]
Method:     DELETE
Header:     Content-type:application/json
Parameter:
    -  `taskId`: 作业id
  
示例：
{
    "taskId": "1",
}
Response:
    - `status`: 0->is OK 
                10->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use interface
```

> **返回结果示例：**

``` json
{
    "status": "0",
    "data":{
        "info":"ok"
    }
}
```
####11.1.8  学期班级年级查询接口
>引用9.3.1

####11.1.9  课程查询接口
>引用9.2.1

####11.1.10  选择班级接口
>引用1.2.1

####11.1.10  图片上传接口
>引用2.1.6
