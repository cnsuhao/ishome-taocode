[toc]

## 1 手机端接口说明

>标签：接口\手机端接口

---
###  文档更新说明
> 更新时间：2016-08-02

###  接口调用说明
 > 手机端分为教师查询端及家长查询端，本接口主要为该两部分提供内容，同时兼顾教师后台页面的部分功能。本接口分为三个部分，分别为：新闻管理接口部分，通讯录查询部分（补充后台教师管理部分缺少的功能），以及值日值周查询一个学期（阶段）内，哪些日期有特定老师的值日值周安排和值日值周查每天哪几个老师轮值（好像已经有了）的接口；
 
 > 新闻CMS接口部分的主要功能是实现新闻的展示，特定栏目的展示，特定新闻的查询，以及栏目使用的图片轮播模式；

 > 通讯录部分主要加入了教师查询其任课班级，以及班级查询对应的任课老师，和班级下面的家长列表查询；
 
 > 值日值周部分主要加入按照时间阶段返回那一日有特定教师的值日信息，值周信息。课表部分需要加入类似的按照时间阶段返回那一日有特定教师的上课信息接口。（按天或者按周查询对应的值日和值周安排可以通过工作管理页面的值日值周查询页面完成）；


### 1.1 新闻展示接口部分
#### 1.1.1 栏目查询接口
>详见
>2 校园新闻管理
>2.2 新闻栏目管理页面接口
>2.2.1 新闻栏目查询接口

#### 1.1.2 新闻查询接口（有问题，待查）
/qxy/newlist/column=[col_id|]&page=[page]&type=[type]&token=[token]
> 新闻列表查询接口返回了当前的新闻列表，以时间倒序，显示指定时间内的新闻内容列表供管理员查看（注意：栏目设置为暂停的栏目下的新闻不可见，接口关联查询要加上）
> 新闻列表查询接口需要使用Token验证查询者身份

``` json
Url:        /qxy/news/column=[col_id]&time=[start_time|end_time]&page=[page]&size=[size]&type=[type]&token=[token]
Method:     GET
Header:     Content-type:application/json
Parameter:
    - 'column': 指定搜索的栏目ID，多个ID用"|"分割，无column参数或参数无效时返回全部数据
    - 'time':   指定发布时间间隔的文章列表，起点时间与终点时间以"|"分割
    - `page`:   分页编号，分页为0或者空时，返回全部数据
    - `size`:   每页数据条数，为0或空时，默认返回12条数据
    - `type`:   新闻类型0-代表所有审核通过的，1-返回所有新闻，不传则默认返回所有审核通过的
Response:
    - `status`：0->成功
                1->无效的栏目id
                11->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use interface
    - 'newslist':        新闻数据json
    - 'count':       当前返回新闻数据条数
    - 'allnews':     全部提交的新闻数据条数
    - 'publishnews': 全部可见新闻数据条数
```

> **返回结果示例：**

``` json
{
    "status": 0,
    "data": {
        "allnews":"70",
        "publishnews":"68",
        "page":"2",
        "size":"12",
        "count":"20",
        "newslist":[
            {
                "news_id": "122",
                "title": "学校建设迈入新阶段",
                "is_top": "1",          ＃是不是置顶0-非置顶；1-置顶
                "is_pic": "1",          ＃是不是包括图片0-不包括；1-包括
                "is_audit":"1",         #0-未审核，1-审核通过，2-审核驳回
                "is_homenews":"1",      #是否为首页轮播0-否，1-是
                "author": "212",        ＃作者id（tid）
                "author_name": "张俪",   ＃作者名（对应teacher_name）
                "colume_id": "12",      ＃发布栏目id
                "colume_name": "校园风采",   ＃发布栏目名(对应栏目title)
                "publish_time": "1465228800"   #发布时间
            },
            {
                "news_id": "123",
                "title": "学校建设迈入新阶段2",
                "is_top": "1",          ＃是不是置顶0-非置顶；1-置顶
                "is_pic": "1",          ＃是不是包括图片0-不包括；1-包括
                "is_audit":"1",         #0-未审核，1-审核通过，2-审核驳回
                "is_homenews":"1",      #是否为首页轮播0-否，1-是
                "author": "212",        ＃作者id（tid）
                "author_name": "张俪",   ＃作者名（对应teacher_name）
                "colume_id": "12",      ＃发布栏目id
                "colume_name": "校园风采",   ＃发布栏目名(对应栏目title)
                "publish_time": "1465228800"   #发布时间
            }
        ]
    }
}
```
#### 1.1.3 新闻内容查询接口
>2 校园新闻页面接口说明
>2.1 新闻管理页面接口
>2.1.2 新闻详情查看接口

#### 1.1.4 轮播新闻查询接口
>需要token验证
``` json
Url:        /qxy/homenews/list/token=[token]
Method:     GET
Header:     Content-type:application/json
Parameter:
    - 无
Response:
    - `status`：0->成功
                1->无效的栏目id
                11->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use interface
    - 'homenews':    轮播新闻数据json
    - 'count':       当前返回新闻数据条数
    - 'news_id':     全部提交的新闻数据条数
    - 'title':       新闻标题
    - 'pic':         轮播图
```

> **返回结果示例：**

``` json
{
    "status": 0,
    "data": {
        "count":"2",
        "homenews":[
            {
                "news_id": "122",
                "title": "学校建设迈入新阶段",
                "pic":"url"
            },
            {

                "news_id": "123",
                "title": "学校建设迈入新阶段sss",
                "pic":"url"
            }
        ]
    }
}
```
### 1.2 通讯录部分
#### 1.2.1 教师查询任课班级
>需要token验证

``` json
Url:        /qxy/teacher/class/term=[term_id]&teacher=[tid]&token=[token]
Method:     GET
Header:     Content-type:application/json
Parameter:
    - `term`:      学期id   不填则默认为当前学期
    - `teacher`:   教师id   不填则为所有教师
Response:
    - `status`：0->is OK
                1->失败，无调用权力打开id内容
               11->token is invalid
               12->token is timeout
               13->Illegal interface calls, not power use interface
    - `count`:        返回的教师数量
    - `teacherlist`:  教师json
    - `classlist`:    班级json
```

> **返回结果示例：**

``` json
{
    "status": 0,
    "data":{
	    "count":"2",
	    "tid":"12",
	    "teacher_name":"张老师",
	    "is_leader":"1",       #是否为班主任 0-否，1-是
	    "classlist":[
		    {
			    "cid":"123",
			    "term_name":"2016-2017-1",
			    "grader_name":"高一",
			    "class_name":"一班"
		    }，
		    {
			    "cid":"123",
			    "term_name":"2016-2017-1",
			    "grader_name":"高一",
			    "class_name":"一班"
		    }
	    ]
    }
}
```

#### 1.2.1 班级查询任课老师
>需要token验证

``` json
Url:        /qxy/class/teacher/term=[term]&class=[cid]&token=[token]
Method:     GET
Header:     Content-type:application/json
Parameter:
    - `term`:      学期id   不填则默认为当前学期
    - `class`:     班级id   不填则为所有班级
Response:
    - `status`：0->is OK
                1->失败，无调用权力打开id内容
               11->token is invalid
               12->token is timeout
               13->Illegal interface calls, not power use interface
    - `count`:        返回的班级数量
    - `teacherlist`:  教师json
    - `classlist`:    班级json
```

> **返回结果示例：**

``` json
{
    "status": 0,
    "data":{
	    "cid":"12",
	    "term_name":"2016-2017-1",
	    "grader_name":"高一",
	    "class_name":"一班",
	    "count":"2",
	    "teacherlist":[
		    {
			    "tid":"123",
			    "teacher_name":"张老师",
			    "course_id":"12",
			    "course_name":"语文",
			    "is_leader":"1"       #是否为班主任 0-否，1-是
		    }，
		    {

			    "tid":"123",
			    "teacher_name":"张老师",
			    "course_id":"12",
			    "course_name":"语文",
			    "is_leader":"1"       #是否为班主任 0-否，1-是
		    }
	    ]
    }
}
```


#### 1.2.1 班级查询家长通讯录
> 班级学生查询接口返回当时学期的特定班级的家长数据，班级学生家长页面接口支持分页，支持根据学生名条件查询

> 班级查询家长接口需要使用Token验证查询者身份

``` json
Url:        /qxy/class/parent/term=[term]&class=[cid]&student=[student_id]&page=[page]&size=[size]&token=[token]
Method:     GET
Header:     Content-type:application/json
Parameter:
    - `term`:   查询的学期id
    - `class`:  查询的班级cid
    - `student`:   学生id
    - `page`:   分页编号，分页为0或者空时，返回全部数据
    - `size`:   每页数据条数，为0或空时，默认返回12条数据
Response:
    - `status`：0->token is OK 
                11->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use interface
    - `parents`:       家长内容JSON
    - `count`:         家长总数
    - `role`:          角色：1-爸爸;2-妈妈;3-爷爷;4-奶奶;5-其他
    - `work_unit`:     工作单位
    - `position`:      职位
    - `is_default`:    是否缺省家长，0-否；1-是
```

> **返回结果示例：**

``` json
{
    "staus": 0,
    "data":{
        "cid":"12",
	    "term_name":"2016-2017-1",
	    "grader_name":"高一",
	    "class_name":"一班",
        "page":"2",
        "size":"21",
        "count":"45",
        "parents":[
            {   
                "parent_id":"12",
                "parent_name":"张三三",
                "role":"1",    #角色：1-爸爸;2-妈妈;3-爷爷;4-奶奶;5-其他
                "student_id":"3434",
                "student_name":"张高丽",
                "phone":"13434567890",
                "work_unit":"南水北调",    #工作单位
                "position":"工程师",       #职位
                "is_default":"0"   #是否缺省家长，0-否；1-是
            },
            {   
                "parent_id":"12",
                "parent_name":"张三三",
                "role":"1",    #1-爸爸;2-妈妈;3-爷爷;4-奶奶;5-其他
                "student_id":"3434",
                "student_name":"张高丽",
                "phone":"13434567890",
                "work_unit":"南水北调",
                "position":"工程师",
                "is_default":"0"   #是否缺省家长，0-否；1-是
            },
            {   
                "parent_id":"12",
                "parent_name":"张三三",
                "role":"1",    #1-爸爸;2-妈妈;3-爷爷;4-奶奶;5-其他
                "student_id":"3434",
                "student_name":"张高丽",
                "phone":"13434567890",
                "work_unit":"南水北调",
                "position":"工程师",
                "is_default":"0"   #是否缺省家长，0-否；1-是
            }
        ]
    }
}
```

#### 1.2.3 家长角色对应学生所属班
> 家长查询对应学生所属班级
> 需要使用Token验证查询者身份

``` json
Url:        /qxy/parent/class/term=[term]&parent=[parent_id]&student=[student_id]&token=[token]
Method:     GET
Header:     Content-type:application/json
Parameter:
    - `term`:   查询的学期id      不填则为默认学期
    - `class`:  查询的班级cid
    - `student`:   学生id
Response:
    - `status`：0->token is OK 
                11->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use interface
    - `classlist`:       班级内容JSON
    - `count`:           班级总数
```

> **返回结果示例：**

``` json
{
    "staus": 0,
    "data":{
	    "term_name":"2016-2017-2",
	    "parent_name":"张三丰",
        "studentlist":[
            {   
                "student_id":"12",
                "student_name":"大儿子",
                "cid":"12",
                "grade_name":"初三",
                "class_name":"三班"
            },
            {   
                "student_id":"12",
                "student_name":"二儿子",
                "cid":"12",
                "grade_name":"初三",
                "class_name":"三班"
            },
            {   
                "student_id":"12",
                "student_name":"三儿子",
                "cid":"12",
                "grade_name":"初三",
                "class_name":"三班"
            }
        ]
    }
}
```

### 1.3 值日值周接口部分
#### 1.3.1 值日值周信息日历表状态查询接口
引用工作管理-值日值周中值日值周信息日历表状态查询接口

#### 1.3.1 值周工作安排查询接口
引用工作管理-值日值周中值周工作安排查询接口

#### 1.3.1 值日工作安排查询接口
引用工作管理-值日值周中值日工作安排查询接口

