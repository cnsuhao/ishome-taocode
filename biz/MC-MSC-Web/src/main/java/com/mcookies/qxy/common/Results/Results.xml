<?xml version='1.0' encoding='UTF-8' ?> 
<!DOCTYPE mapper
    PUBLIC '-//mybatis.org//DTD Dao 3.0//EN' 
    'http://mybatis.org/dtd/mybatis-3-mapper.dtd' >
<!-- 成绩表 -->
<!-- 需要和DAO保持完全路径一致 -->
<mapper namespace='com.mcookies.qxy.common.Results.ResultsDao'>
    <!-- 表字段信息  -->
    <sql id='tableColumns'>
        results_id,results_tag_id,course_id,cid,student_id,student_name,score,test_time,is_use,create_time,creator,update_time,updator
    </sql>

    <!-- 根据条件更新所有记录 -->
    <update id='doUpdateAll' parameterType='ResultsDBO'>
        UPDATE results SET update_time = #{updateTime} <!-- 更新时间、更新者 -->
        <if test=" resultsId != null and resultsId !='' "><!-- 成绩id -->
            ,results_id = #{resultsId}
        </if>
        <if test=" resultsTagId != null and resultsTagId !='' "><!-- 成绩标签id -->
            ,results_tag_id = #{resultsTagId}
        </if>
        <if test=" courseId != null and courseId !='' "><!-- 课程id -->
            ,course_id = #{courseId}
        </if>
        <if test=" cid != null and cid !='' "><!-- 班级id -->
            ,cid = #{cid}
        </if>
        <if test=" studentId != null and studentId !='' "><!-- 学生id -->
            ,student_id = #{studentId}
        </if>
        <if test=" studentName != null and studentName !='' "><!-- 学生姓名 -->
            ,student_name = #{studentName}
        </if>
        <if test=" score != null and score !='' "><!-- 分数 -->
            ,score = #{score}
        </if>
        <if test=" testTime != null and testTime !='' "><!-- 考试时间 -->
            ,test_time = #{testTime}
        </if>
        <if test=" isUse != null and isUse !='' "><!-- 是否启用 -->
            ,is_use = #{isUse}
        </if>
        <if test=" createTime != null and createTime !='' "><!-- 创建时间 -->
            ,create_time = #{createTime}
        </if>
        <if test=" creator != null and creator !='' "><!-- 创建者 -->
            ,creator = #{creator}
        </if>
        <if test=" updator != null and updator !='' "><!-- 最后更新者 -->
            ,updator = #{updator}
        </if>
        WHERE 1 = 1 
            <if test=" resultsId != null and resultsId !='' "><!-- 成绩id -->
                AND results_id = #{resultsId}
            </if>
            <if test=" resultsTagId != null and resultsTagId !='' "><!-- 成绩标签id -->
                AND results_tag_id = #{resultsTagId}
            </if>
            <if test=" courseId != null and courseId !='' "><!-- 课程id -->
                AND course_id = #{courseId}
            </if>
            <if test=" cid != null and cid !='' "><!-- 班级id -->
                AND cid = #{cid}
            </if>
            <if test=" studentId != null and studentId !='' "><!-- 学生id -->
                AND student_id = #{studentId}
            </if>
            <if test=" studentName != null and studentName !='' "><!-- 学生姓名 -->
                AND student_name = #{studentName}
            </if>
            <if test=" score != null and score !='' "><!-- 分数 -->
                AND score = #{score}
            </if>
            <if test=" testTime != null and testTime !='' "><!-- 考试时间 -->
                AND test_time = #{testTime}
            </if>
            <if test=" isUse != null and isUse !='' "><!-- 是否启用 -->
                AND is_use = #{isUse}
            </if>
            <if test=" createTime != null and createTime !='' "><!-- 创建时间 -->
                AND create_time = #{createTime}
            </if>
            <if test=" creator != null and creator !='' "><!-- 创建者 -->
                AND creator = #{creator}
            </if>
            <if test=" updateTime != null and updateTime !='' "><!-- 更新时间 -->
                AND update_time = #{updateTime}
            </if>
            <if test=" updator != null and updator !='' "><!-- 最后更新者 -->
                AND updator = #{updator}
            </if>
    </update>
    <!-- 查询分页数据信息  -->
    <select id='doSelectPage' parameterType='ResultsDBO' resultType='ResultsDBO'>
        SELECT <include refid='tableColumns'/> FROM results
        WHERE 1 = 1 
        <if test=" resultsId != null and resultsId !='' "><!-- 成绩id -->
            AND results_id = #{resultsId}
        </if>
        <if test=" resultsTagId != null and resultsTagId !='' "><!-- 成绩标签id -->
            AND results_tag_id = #{resultsTagId}
        </if>
        <if test=" courseId != null and courseId !='' "><!-- 课程id -->
            AND course_id = #{courseId}
        </if>
        <if test=" cid != null and cid !='' "><!-- 班级id -->
            AND cid = #{cid}
        </if>
        <if test=" studentId != null and studentId !='' "><!-- 学生id -->
            AND student_id = #{studentId}
        </if>
        <if test=" studentName != null and studentName !='' "><!-- 学生姓名 -->
            AND student_name = #{studentName}
        </if>
        <if test=" score != null and score !='' "><!-- 分数 -->
            AND score = #{score}
        </if>
        <if test=" testTime != null and testTime !='' "><!-- 考试时间 -->
            AND test_time = #{testTime}
        </if>
        <if test=" isUse != null and isUse !='' "><!-- 是否启用 -->
            AND is_use = #{isUse}
        </if>
        <if test=" createTime != null and createTime !='' "><!-- 创建时间 -->
            AND create_time = #{createTime}
        </if>
        <if test=" creator != null and creator !='' "><!-- 创建者 -->
            AND creator = #{creator}
        </if>
        <if test=" updateTime != null and updateTime !='' "><!-- 更新时间 -->
            AND update_time = #{updateTime}
        </if>
        <if test=" updator != null and updator !='' "><!-- 最后更新者 -->
            AND updator = #{updator}
        </if>
    </select>

    <!-- 插入一条数据 -->
    <insert id='doInsert' parameterType='ResultsDBO'>
        INSERT INTO results
          ( <include refid='tableColumns'/>) 
        VALUES 
          ( #{resultsId},#{resultsTagId},#{courseId},#{cid},#{studentId},#{studentName},#{score},#{testTime},#{isUse},#{createTime},#{creator},#{updateTime},#{updator} )
    </insert>
    <!-- 修改一条数据 -->
    <update id='doUpdate' parameterType='ResultsDBO'>
        UPDATE results SET update_time = #{updateTime} <!-- 更新时间、更新者 -->
        <if test=" resultsId != null and resultsId !='' "><!-- 成绩id -->
            ,results_id = #{resultsId}
        </if>
        <if test=" resultsTagId != null and resultsTagId !='' "><!-- 成绩标签id -->
            ,results_tag_id = #{resultsTagId}
        </if>
        <if test=" courseId != null and courseId !='' "><!-- 课程id -->
            ,course_id = #{courseId}
        </if>
        <if test=" cid != null and cid !='' "><!-- 班级id -->
            ,cid = #{cid}
        </if>
        <if test=" studentId != null and studentId !='' "><!-- 学生id -->
            ,student_id = #{studentId}
        </if>
        <if test=" studentName != null and studentName !='' "><!-- 学生姓名 -->
            ,student_name = #{studentName}
        </if>
        <if test=" score != null and score !='' "><!-- 分数 -->
            ,score = #{score}
        </if>
        <if test=" testTime != null and testTime !='' "><!-- 考试时间 -->
            ,test_time = #{testTime}
        </if>
        <if test=" isUse != null and isUse !='' "><!-- 是否启用 -->
            ,is_use = #{isUse}
        </if>
        <if test=" createTime != null and createTime !='' "><!-- 创建时间 -->
            ,create_time = #{createTime}
        </if>
        <if test=" creator != null and creator !='' "><!-- 创建者 -->
            ,creator = #{creator}
        </if>
        <if test=" updator != null and updator !='' "><!-- 最后更新者 -->
            ,updator = #{updator}
        </if>
        WHERE 1 = 1 
            <if test=" resultsId != null and resultsId !='' "><!-- 成绩id -->
                AND results_id = #{resultsId}
            </if>
    </update>
    <!-- 逻辑删除一条数据 -->
    <delete id='toDelete' parameterType='ResultsDBO'>
        UPDATE results SET ddd='1', update_time = #{updateTime}, uu2 = #{uu2} WHERE update_time = #{updateTime}
            <if test=" resultsId != null and resultsId !='' "><!-- 成绩id -->
                AND results_id = #{resultsId}
            </if>
    </delete>
    <!-- 物理删除一条数据 -->
    <delete id='doDelete' parameterType='ResultsDBO'>
        DELETE FROM results WHERE update_time = #{updateTime}
            <if test=" resultsId != null and resultsId !='' "><!-- 成绩id -->
                AND results_id = #{resultsId}
            </if>
    </delete>
    <!-- 查询一条数据  -->
    <select id='doRead' parameterType='ResultsDBO' resultType='ResultsDBO'>
        SELECT <include refid='tableColumns'/> FROM results WHERE 1 = 1
            <if test=" resultsId != null and resultsId !='' "><!-- 成绩id -->
                AND results_id = #{resultsId}
            </if>
    </select>
        <!-- 分页 获取学生总成绩列表信息 -->
	<select id="doSelectPageResultDESC" parameterType="ResultsDBO" resultType="com.mcookies.qxy.common.Results.ResultsPVO">	
		SELECT
		d.student_id,
		d.student_name,
	    d.number,
		d.totalPoints,
		CASE
		WHEN @rowtotal = d.totalPoints THEN
			@ranking
		WHEN @rowtotal := d.totalPoints THEN
			@ranking :=@ranking + 1
		WHEN @rowtotal = 0 THEN
			@ranking :=@ranking + 1
		END AS ranking
		FROM
			(
						SELECT
						a.student_id,
						a.student_name,
						b.number,
						Sum(a.score) AS totalPoints
						FROM
						results AS a
						LEFT JOIN u_student AS b ON a.student_id = b.student_id
						WHERE 1 = 1 
						<if test=" resultsTagId != null and resultsTagId !='' "><!-- 成绩标签名称 -->
						    AND a.results_tag_id = #{resultsTagId}
						</if>
						<if test=" cid != null and cid !='' "><!-- 班级id -->
						    AND a.cid = #{cid}
						</if>
						GROUP BY
						a.student_id,
						a.student_name
						ORDER BY
						totalPoints DESC
			) AS d,
			(
				SELECT
					@ranking := 0 ,@rowtotal := NULL
			) r
	</select>
			    <!--  根据cid班级id，resultsTagId成绩标签id获取班级学生成绩-->
	<select id="doReadResult" parameterType="ResultsDBO" resultType="com.mcookies.qxy.common.Results.ResultsPVO">	
	SELECT DISTINCT
	b.results_tag_name,
	a.results_tag_id,
	a.cid,
	CONCAT(d.grade_name, c.class_name) AS className
	FROM
	results AS a
	LEFT JOIN results_tag AS b ON a.results_tag_id = b.results_tag_id
	LEFT JOIN class AS c ON a.cid = c.cid
	LEFT JOIN s_grade_label AS d ON c.grade_id = d.grade_id
	WHERE 1 = 1 
	<if test=" resultsTagId != null and resultsTagId !='' "><!-- 成绩标签名称 -->
	    AND a.results_tag_id = #{resultsTagId}
	</if>
	<if test=" cid != null and cid !='' "><!-- 班级id -->
	    AND a.cid = #{cid}
	</if>
	</select>
	 <!-- 根据学生id，学号id，resultsTagId成绩标签id获取班级学生总成绩列表 -->
	<select id="doSelectResult" parameterType="com.mcookies.qxy.common.Results.ResultsPVO" resultType="com.mcookies.qxy.common.Results.ResultsPVO">	
	SELECT
		e.student_id,
		e.student_name,
	    e.number,
		e.totalPoints,
	  e.ranking
	FROM
	(
	SELECT
		d.student_id,
		d.student_name,
	  d.number,
		d.totalPoints,
		CASE
	WHEN @rowtotal = d.totalPoints THEN
		@ranking
	WHEN @rowtotal := d.totalPoints THEN
		@ranking :=@ranking + 1
	WHEN @rowtotal = 0 THEN
		@ranking :=@ranking + 1
	END AS ranking
	FROM
		(
					SELECT
					a.student_id,
					a.student_name,
					b.number,
					Sum(a.score) AS totalPoints
					FROM
					results AS a
					LEFT JOIN u_student AS b ON a.student_id = b.student_id
					 WHERE 1 = 1 
					<if test=" resultsTagId != null and resultsTagId !='' "><!-- 成绩标签名称 -->
					    AND a.results_tag_id = #{resultsTagId}
					</if>
					GROUP BY
					a.student_id,
					a.student_name
					ORDER BY
					totalPoints DESC
		) AS d,
		(
			SELECT
				@ranking := 0 ,@rowtotal := NULL
		) r
	) AS e
	WHERE 1 = 1 
	<if test=" studentId != null and studentId !='' "><!-- 成绩标签名称 -->
	    AND e.student_id = #{studentId}
	</if>
	<if test=" number != null and number !='' "><!-- 成绩标签名称 -->
	    AND e.number = #{number}
	</if>
	</select>
	<!--  根据学生id，学号id，resultsTagId成绩标签id获取班级学生成绩-->
	<select id="doReadResultByStudentId" parameterType="com.mcookies.qxy.common.Results.ResultsPVO" resultType="com.mcookies.qxy.common.Results.ResultsPVO">	
	SELECT DISTINCT
	b.results_tag_name,
	a.results_tag_id,
	a.cid,
	CONCAT(d.grade_name, c.class_name) AS className
	FROM
	results AS a
	LEFT JOIN results_tag AS b ON a.results_tag_id = b.results_tag_id
	LEFT JOIN class AS c ON a.cid = c.cid
	LEFT JOIN s_grade_label AS d ON c.grade_id = d.grade_id
	LEFT JOIN u_student AS e ON a.student_id = e.student_id
		WHERE 1 = 1 
		<if test=" resultsTagId != null and resultsTagId !='' "><!-- 成绩标签名称 -->
		    AND a.results_tag_id = #{resultsTagId}
		</if>
		<if test=" studentId != null and studentId !='' "><!-- 成绩标签名称 -->
		    AND a.student_id = #{studentId}
		</if>
		<if test=" number != null and number !='' "><!-- 成绩标签名称 -->
		    AND e.number = #{number}
		</if>
      </select>
      	 <!-- 根据学生id ,cid，resultsTagId成绩标签id获取班级学生课程成绩排名 -->
	<select id="doSelectByCidRtidStuId" parameterType="ResultsDBO" resultType="com.mcookies.qxy.common.Results.ResultsPVO">	
	SELECT
		e.course_id,
		e.course_name, 
		e.courseScore,
	  e.courseRanking,
	  e.update_time
	FROM
	(
	SELECT
		d.course_id,
		d.course_name,
	  d.student_id,
		d.courseScore,
		CASE
	WHEN @rowtotal = d.courseScore THEN
		@ranking
	WHEN @rowtotal := d.courseScore THEN
		@ranking :=@ranking + 1
	WHEN @rowtotal = 0 THEN
		@ranking :=@ranking + 1
	END AS courseRanking,
	 d.update_time
	FROM
		(
			SELECT
				a.course_id,
				b.course_name,
				a.student_id,
				a.score AS courseScore,
				a.update_time
			FROM
				results AS a
			LEFT JOIN s_course AS b ON a.course_id = b.course_id
			LEFT JOIN class AS c ON a.cid = c.cid
			WHERE   1 = 1						
		<if test=" resultsTagId != null"><!-- 成绩标签名称 -->
		    AND a.results_tag_id = #{resultsTagId}
		</if>
		<if test=" cid != null"><!-- 班级cid名称 -->
		    AND a.cid = #{cid}
		</if>
		<if test=" courseId != null"><!-- 课程id名称 -->
		    AND a.course_id = #{courseId}
		</if>
	    ORDER BY a.score DESC
		) AS d,
		(
			SELECT
				@ranking := 0 ,@rowtotal := NULL
		) r
	)as e
	WHERE   1 = 1						
	<if test=" studentId != null"><!-- 学生id名称 -->
	    AND e.student_id = #{studentId}
	</if>
	</select>
	<!--  根据学生id，学号，resultsTagId成绩标签id获取班级学生成绩-->
	<select id="doReadByRTIdSId" parameterType="ResultsDBO" resultType="com.mcookies.qxy.common.Results.ResultsPVO">	
		SELECT
		b.results_tag_name,
		a.results_tag_id,
		a.cid,
		CONCAT(c.class_name, d.grade_name) AS className,
		a.student_id,
		a.student_name,
		e.number,
		Sum(a.score) AS totalPoints
	FROM
		results AS a
	LEFT JOIN results_tag AS b ON a.results_tag_id = b.results_tag_id
	LEFT JOIN class AS c ON a.cid = c.cid
	LEFT JOIN s_grade_label AS d ON c.grade_id = d.grade_id
	LEFT JOIN u_student AS e ON a.student_id = e.student_id
		WHERE 1 = 1 
		<if test=" resultsTagId != null and resultsTagId !='' "><!-- 成绩标签名称 -->
		    AND a.results_tag_id = #{resultsTagId}
		</if>
		<if test=" studentId != null and studentId !='' "><!-- 学生id -->
		    AND a.student_id = #{studentId}
		</if>
	GROUP BY
		a.results_tag_id,
		a.cid,
		a.student_id,
		a.student_name,
		e.number
		
      </select>
      	<!--  根据成绩标签id,班级id，resultsTagId成绩标签id获取班级学生成绩状态信息-->
	<select id="findByRTIdCidCourseId" parameterType="ResultsDBO" resultType="com.mcookies.qxy.common.Results.ResultsPVO">	
	SELECT 
	a.course_id,
	b.course_name,
	a.score
	FROM
	results AS a
	LEFT JOIN class_course AS b ON a.course_id = b.course_id
		WHERE 1 = 1 
		<if test=" resultsTagId != null and resultsTagId !='' "><!-- 成绩标签名称 -->
		    AND a.results_tag_id = #{resultsTagId}
		</if>
		<if test=" cid != null and cid !='' "><!-- 班级id -->
		    AND a.cid = #{cid}
		</if>
	 	<if test=" courseId != null and courseId !='' "><!-- 课程id -->
		    AND a.course_id = #{courseId}
		</if>
     GROUP BY
	 b.course_id			
      </select>
    <!-- 分页 获取学生总成科目分数正序排名列表信息 -->
	<select id="doSelectPageResASC" parameterType="ResultsDBO" resultType="com.mcookies.qxy.common.Results.ResultsPVO">	
	SELECT
				d.student_id,
				d.student_name,
				d.number,
				d.courseScore,
		CASE
	WHEN @rowtotal = d.courseScore THEN
		@ranking
	WHEN @rowtotal := d.courseScore THEN
		@ranking :=@ranking + 1
	WHEN @rowtotal = 0 THEN
		@ranking :=@ranking + 1
	END AS courseRanking
	FROM
		(
			SELECT
				a.student_id,
				a.student_name,
				b.number,
				a.score AS courseScore
			FROM
				results AS a
			INNER JOIN u_student AS b ON a.student_id = b.student_id
				WHERE 1 = 1 
		<if test=" resultsTagId != null and resultsTagId !='' "><!-- 成绩标签名称 -->
		    AND a.results_tag_id = #{resultsTagId}
		</if>
		<if test=" cid != null and cid !='' "><!-- 班级id -->
		    AND a.cid = #{cid}
		</if>
	 	<if test=" courseId != null and courseId !='' "><!-- 课程id -->
		    AND a.course_id = #{courseId}
		</if>
			ORDER BY
				courseScore ASC
		) AS d,
		(
			SELECT
				@ranking := 0 ,@rowtotal := NULL
		) r
	</select> 
	    <!-- 分页 获取学生总成科目分数倒序排名列表信息 -->
	<select id="doSelectPageResDESC" parameterType="ResultsDBO" resultType="com.mcookies.qxy.common.Results.ResultsPVO">	
	SELECT
				d.student_id,
				d.student_name,
				d.number,
				d.courseScore,
		CASE
	WHEN @rowtotal = d.courseScore THEN
		@ranking
	WHEN @rowtotal := d.courseScore THEN
		@ranking :=@ranking + 1
	WHEN @rowtotal = 0 THEN
		@ranking :=@ranking + 1
	END AS courseRanking
	FROM
		(
			SELECT
				a.student_id,
				a.student_name,
				b.number,
				a.score AS courseScore
			FROM
				results AS a
			INNER JOIN u_student AS b ON a.student_id = b.student_id
				WHERE 1 = 1 
		<if test=" resultsTagId != null and resultsTagId !='' "><!-- 成绩标签名称 -->
		    AND a.results_tag_id = #{resultsTagId}
		</if>
		<if test=" cid != null and cid !='' "><!-- 班级id -->
		    AND a.cid = #{cid}
		</if>
	 	<if test=" courseId != null and courseId !='' "><!-- 课程id -->
		    AND a.course_id = #{courseId}
		</if>
			ORDER BY
				courseScore DESC
		) AS d,
		(
			SELECT
				@ranking := 0 ,@rowtotal := NULL
		) r
	</select> 
          	<!--  根据成绩标签id,班级id，resultsTagId，课程id获取班级学生科目信息-->
	<select id="findByRTIdCidCsId" parameterType="ResultsDBO" resultType="com.mcookies.qxy.common.Results.ResultsPVO">	
	SELECT DISTINCT
		b.results_tag_name,
		a.results_tag_id,
		a.cid,
		CONCAT(d.grade_name, c.class_name) AS className,
		a.course_id,
		e.course_name
	FROM
		results AS a
	LEFT JOIN results_tag AS b ON a.results_tag_id = b.results_tag_id
	LEFT JOIN class AS c ON a.cid = c.cid
	LEFT JOIN s_grade_label AS d ON c.grade_id = d.grade_id
	LEFT JOIN class_course AS e ON a.course_id = e.course_id
				WHERE 1 = 1 
		<if test=" resultsTagId != null and resultsTagId !='' "><!-- 成绩标签名称 -->
		    AND a.results_tag_id = #{resultsTagId}
		</if>
		<if test=" cid != null and cid !='' "><!-- 班级id -->
		    AND a.cid = #{cid}
		</if>
	 	<if test=" courseId != null and courseId !='' "><!-- 课程id -->
		    AND a.course_id = #{courseId}
		</if>	
      </select>
    <!--  获得年级信息-->  
    <select id="doSelectPageGrade" parameterType="com.mcookies.qxy.common.Results.ResultsPVO" resultType="com.mcookies.qxy.common.Results.ResultsPVO">	
	SELECT 
	 DISTINCT  
	c.grade_id,
	c.grade_name
	FROM
	results AS a
	LEFT JOIN class AS b ON a.cid = b.cid
	LEFT JOIN s_grade_label AS c ON b.grade_id = c.grade_id
	INNER JOIN class_course AS d ON a.course_id = d.course_id
	 WHERE 1 = 1 
	<if test=" resultsTagId != null "><!-- 成绩标答表id -->   
	     AND a.results_tag_id = #{resultsTagId}
	</if>
	<if test=" termId != null "><!-- 学期id -->   
	     AND b.term_id = #{termId}
	</if>
	<if test=" tid != null "><!-- 老师id -->   
	     AND d.tid = #{tid}
	</if>
	</select>
	<!--  获得班级信息-->
	<select id="doSelectClassList" parameterType="com.mcookies.qxy.common.Results.ResultsPVO" resultType="com.mcookies.qxy.common.Results.ResultsPVO">	
	SELECT
	DISTINCT
	a.cid,
	b.class_name
	FROM
	results AS a
	LEFT JOIN class AS b ON a.cid = b.cid
	LEFT JOIN s_grade_label AS c ON b.grade_id = c.grade_id
	LEFT JOIN class_course AS d ON a.course_id = d.course_id
	 WHERE 1 = 1 
	<if test=" resultsTagId != null "><!-- 成绩标答表id -->   
	     AND a.results_tag_id = #{resultsTagId}
	</if>
	<if test=" termId != null "><!-- 学期id -->   
	     AND b.term_id = #{termId}
	</if>
	<if test=" tid != null "><!-- 老师id -->   
	     AND d.tid = #{tid}
	</if>
	<if test=" gradeId != null "><!-- 年级id -->   
	     AND b.grade_id = #{gradeId}
	</if>
	</select>
		<!--   分页 获得年级班级信息-->
	<select id="doSelectPageGradeClassList" parameterType="com.mcookies.qxy.common.Results.ResultsPVO" resultType="com.mcookies.qxy.common.Results.ResultsPVO">	
	SELECT
	DISTINCT
	a.cid,
	b.class_name,
	c.grade_id,
	c.grade_name
	FROM
	results AS a
	LEFT JOIN class AS b ON a.cid = b.cid
	LEFT JOIN s_grade_label AS c ON b.grade_id = c.grade_id
	LEFT JOIN class_course AS d ON a.cid = d.cid
	 WHERE 1 = 1 
	<if test=" resultsTagId != null "><!-- 成绩标答表id -->   
	     AND a.results_tag_id = #{resultsTagId}
	</if>
	<if test=" termId != null "><!-- 学期id -->   
	     AND b.term_id = #{termId}
	</if>
	<if test=" tid != null "><!-- 老师id -->   
	     AND d.tid = #{tid}
	</if>
	</select>
	 <!--  根据cid获得年级和班级情况-->
	<select id="doReadGradeClass" parameterType="ResultsDBO" resultType="com.mcookies.qxy.common.Results.ResultsPVO">	
	SELECT
	d.results_tag_name,
	d.results_tag_id,
	b.term_id,
	c.grade_id,
	c.grade_name,
	a.cid,
	b.class_name
	FROM
	results AS a
	LEFT JOIN class AS b ON a.cid = b.cid
	LEFT JOIN s_grade_label AS c ON b.grade_id = c.grade_id
	INNER JOIN results_tag AS d ON d.results_tag_id = a.results_tag_id
	 WHERE 1 = 1 
	<if test=" cid != null "><!-- 班级id -->   
	     AND a.cid = #{cid}
	</if>
	</select>     
      
</mapper>
