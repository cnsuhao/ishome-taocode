<?xml version='1.0' encoding='UTF-8' ?> 
<!DOCTYPE mapper
    PUBLIC '-//mybatis.org//DTD Dao 3.0//EN' 
    'http://mybatis.org/dtd/mybatis-3-mapper.dtd' >
<!-- OA规则表 -->
<!-- 需要和DAO保持完全路径一致 -->
<mapper namespace='com.mcookies.qxy.common.OaRule.OaRuleDao'>
	<!-- 表字段信息 -->
	<sql id='tableColumns'>
		oarule_id,sid,oatags_id,oarule_name,serial_number,adopt_type,tids,is_use,create_time,creator,update_time,updator
	</sql>

	<!-- 根据条件更新所有记录 -->
	<update id='doUpdateAll' parameterType='OaRuleDBO'>
		UPDATE oa_rule SET update_time = #{updateTime} <!-- 更新时间、更新者 -->
		<if test=" oaruleId != null "><!-- 规则id -->
			,oarule_id = #{oaruleId}
		</if>
		<if test=" sid != null "><!-- 学校id -->
			,sid = #{sid}
		</if>
		<if test=" oatagsId != null "><!-- 标签id -->
			,oatags_id = #{oatagsId}
		</if>
		<if test=" oaruleName != null "><!-- 规则名称 -->
			,oarule_name = #{oaruleName}
		</if>
		<if test=" serialNumber != null "><!-- 规则序号 -->
			,serial_number = #{serialNumber}
		</if>
		<if test=" adoptType != null "><!-- 规则通过方式 -->
			,adopt_type = #{adoptType}
		</if>
		<if test=" tids != null "><!-- 审核人列表 -->
			,tids = #{tids}
		</if>
		<if test=" isUse != null "><!-- 是否启用 -->
			,is_use = #{isUse}
		</if>
		<if test=" createTime != null "><!-- 创建时间 -->
			,create_time = #{createTime}
		</if>
		<if test=" creator != null "><!-- 创建者 -->
			,creator = #{creator}
		</if>
		<if test=" updator != null "><!-- 最后更新者 -->
			,updator = #{updator}
		</if>
		WHERE 1 = 1
		<if test=" oaruleId != null "><!-- 规则id -->
			AND oarule_id = #{oaruleId}
		</if>
		<if test=" sid != null "><!-- 学校id -->
			AND sid = #{sid}
		</if>
		<if test=" oatagsId != null "><!-- 标签id -->
			AND oatags_id = #{oatagsId}
		</if>
		<if test=" oaruleName != null "><!-- 规则名称 -->
			AND oarule_name = #{oaruleName}
		</if>
		<if test=" serialNumber != null "><!-- 规则序号 -->
			AND serial_number = #{serialNumber}
		</if>
		<if test=" adoptType != null "><!-- 规则通过方式 -->
			AND adopt_type = #{adoptType}
		</if>
		<if test=" tids != null "><!-- 审核人列表 -->
			AND tids = #{tids}
		</if>
		<if test=" isUse != null "><!-- 是否启用 -->
			AND is_use = #{isUse}
		</if>
		<if test=" createTime != null "><!-- 创建时间 -->
			AND create_time = #{createTime}
		</if>
		<if test=" creator != null "><!-- 创建者 -->
			AND creator = #{creator}
		</if>
		<if test=" updateTime != null "><!-- 更新时间 -->
			AND update_time = #{updateTime}
		</if>
		<if test=" updator != null "><!-- 最后更新者 -->
			AND updator = #{updator}
		</if>
	</update>
	<!-- 查询分页数据信息 -->
	<select id='doSelectPage' parameterType='OaRuleDBO' resultType='com.mcookies.qxy.common.OaRule.OaRulePVO'>
		SELECT
		<include refid='tableColumns' />
		FROM oa_rule
		WHERE 1 = 1
		<if test=" oaruleId != null "><!-- 规则id -->
			AND oarule_id = #{oaruleId}
		</if>
		<if test=" sid != null "><!-- 学校id -->
			AND sid = #{sid}
		</if>
		<if test=" oatagsId != null "><!-- 标签id -->
			AND oatags_id = #{oatagsId}
		</if>
		<if test=" oaruleName != null "><!-- 规则名称 -->
			AND oarule_name = #{oaruleName}
		</if>
		<if test=" serialNumber != null "><!-- 规则序号 -->
			AND serial_number = #{serialNumber}
		</if>
		<if test=" adoptType != null "><!-- 规则通过方式 -->
			AND adopt_type = #{adoptType}
		</if>
		<if test=" tids != null "><!-- 审核人列表 -->
			AND tids = #{tids}
		</if>
		<if test=" isUse != null "><!-- 是否启用 -->
			AND is_use = #{isUse}
		</if>
		<if test=" createTime != null "><!-- 创建时间 -->
			AND create_time = #{createTime}
		</if>
		<if test=" creator != null "><!-- 创建者 -->
			AND creator = #{creator}
		</if>
		<if test=" updateTime != null "><!-- 更新时间 -->
			AND update_time = #{updateTime}
		</if>
		<if test=" updator != null "><!-- 最后更新者 -->
			AND updator = #{updator}
		</if>
	</select>

	<!-- 插入一条数据 -->
	<insert id='doInsert' parameterType='OaRuleDBO'>
		INSERT INTO oa_rule
		(
		<include refid='tableColumns' />
		)
		VALUES
		(
		#{oaruleId},#{sid},#{oatagsId},#{oaruleName},#{serialNumber},#{adoptType},#{tids},#{isUse},#{createTime},#{creator},#{updateTime},#{updator}
		)
	</insert>
	<!-- 修改一条数据 -->
	<update id='doUpdate' parameterType='OaRuleDBO'>
		UPDATE oa_rule SET update_time = #{updateTime} <!-- 更新时间、更新者 -->
		<if test=" oaruleId != null "><!-- 规则id -->
			,oarule_id = #{oaruleId}
		</if>
		<if test=" sid != null "><!-- 学校id -->
			,sid = #{sid}
		</if>
		<if test=" oatagsId != null "><!-- 标签id -->
			,oatags_id = #{oatagsId}
		</if>
		<if test=" oaruleName != null "><!-- 规则名称 -->
			,oarule_name = #{oaruleName}
		</if>
		<if test=" serialNumber != null "><!-- 规则序号 -->
			,serial_number = #{serialNumber}
		</if>
		<if test=" adoptType != null "><!-- 规则通过方式 -->
			,adopt_type = #{adoptType}
		</if>
		<if test=" tids != null "><!-- 审核人列表 -->
			,tids = #{tids}
		</if>
		<if test=" isUse != null "><!-- 是否启用 -->
			,is_use = #{isUse}
		</if>
		<if test=" createTime != null "><!-- 创建时间 -->
			,create_time = #{createTime}
		</if>
		<if test=" creator != null "><!-- 创建者 -->
			,creator = #{creator}
		</if>
		<if test=" updator != null "><!-- 最后更新者 -->
			,updator = #{updator}
		</if>
		WHERE 1 = 1
		<if test=" oaruleId != null "><!-- 规则id -->
			AND oarule_id = #{oaruleId}
		</if>
	</update>
	<!-- 逻辑删除一条数据 -->
	<delete id='toDelete' parameterType='OaRuleDBO'>
		UPDATE oa_rule SET ddd='1', update_time = #{updateTime}, uu2 = #{uu2}
		WHERE update_time = #{updateTime}
		<if test=" oaruleId != null "><!-- 规则id -->
			AND oarule_id = #{oaruleId}
		</if>
	</delete>
	<!-- 物理删除一条数据 -->
	<delete id='doDelete' parameterType='OaRuleDBO'>
		DELETE FROM oa_rule WHERE update_time = #{updateTime}
		<if test=" oaruleId != null "><!-- 规则id -->
			AND oarule_id = #{oaruleId}
		</if>
	</delete>
	<!-- 查询一条数据 -->
	<select id='doRead' parameterType='OaRuleDBO' resultType='OaRuleDBO'>
		SELECT
		<include refid='tableColumns' />
		FROM oa_rule WHERE 1 = 1
		<if test=" oaruleId != null "><!-- 规则id -->
			AND oarule_id = #{oaruleId}
		</if>
	</select>
	<!-- 通过oaTagsIds查数据  -->
    <select id='doSelectByOaTagsIds' parameterType='java.util.List' resultType='OaRuleDBO'>
        SELECT <include refid='tableColumns'/> FROM oa_rule WHERE 1 = 1
                AND oatags_id in
            <foreach item="item" index="index" collection="list" open="(" separator="," close=")">
				#{item}
			</foreach>
    </select>
	<!-- 查找serialNumber大于#{serialNumber}的下一条规则 -->
	<select id='doSelectNextRule' parameterType='OaRuleDBO' resultType='OaRuleDBO'>
		SELECT
		<include refid='tableColumns' />
		FROM oa_rule WHERE oatags_id = #{oatagsId} AND serial_number > #{serialNumber}
		ORDER BY serial_number
		limit 1
	</select>
</mapper>
