[toc]

## 3 工作管理页面接口说明

@(千校云)


>标签： 接口 工作管理

---

### 文档更新说明
> 更新时间：2016-08-02

### 页面说明
 > 工作管理功能包括值日值周管理，工作流程（请假管理，报修管理和活动管理三个页面），命名为：值日值周，工作流程。值日值周页面可以查看值日值周安排以及对值日值周岗位进行管理，还可以新增和修改值日值周内容。

 > 值日值周页面通过选择学期查看对应的值日值周数据，值日值周内容不考虑分页。值日值周岗位列表按键可以打开值日值周岗位管理功能。添加值日事项则可以新增或者修改值日事项。值日值周页面可以点选工作事项安排中的人员一列，直接为值日或者值周安排教工。另外可以批量删除值日和值周工作。还可以选择应用到其他周或者应用到其他日（按星期）。
 > 值日值周岗位列表页面列出了当前所有的岗位职责名称，可以新增岗位，也可以批量的删除岗位，或者删除指定的岗位，并能停用或者启用不同的岗位。
 > 岗位管理页面列出了指定岗位的全部岗位职责，并能对岗位职责进行添加，修改和删除
 > 值日值周添加页面可以用于值日的添加，值周的添加
 > 应用到其他周弹窗用于把值周安排复制到其他周
 > 应用到其他日弹窗用于把值日安排复制到其他日（按星期）
 > 工作流程页面主要处理请假、报修、活动类型的申请、审批与统计；

### 3.1 值日值周页面接口

#### 3.1.1 值日值周信息日历表状态查询接口
>值日值周信息日历表状态查询接口用于查询指定学期中某周或周日有值日值周数据，用户页面显示标记某天或某周有事；获取状态时需要到s_duty_scheduling表中获取岗位类型，根据类型查询有值日或值周事项的天或周；仅返回有效岗位的事项状态信息；
> 需要使用Token验证查询者身份
``` json
Url:        /qxy/schedule/status/term=[term]&teacher=[tid]&token=[token]
Method:     GET
Header:     Content-type:application/json
Parameter:
    - `term`:           指定查询的学期，term为空时查询缺省的学期
    - `teacher`:        查询某教师的值日值周信息，为空时查询所有教师的
Response:
    - `status`:      0->is OK 
                     10->token is invalid
                     12->token is timeout
                     13->Illegal interface calls, not power use interface
    - `schedulestatus`:    值日值周状态内容json
    - `count`:             值周数据内容的条目总数
    - `termlist`:          学期json
    - `is_default`:        是否为缺省学期：0-否，1-是
    - `weeklist`:        有值周事项的周
    - `dayslist`:         有值日事项的天
```

> **返回结果示例：**

``` json
{
    "status": 0,
    "data":{
        "term_name":"2016-2017-1",        
        "count":"3",
        "termlist": [
            {
                "term_id":"1",
                "term_name":"2016-2017-1",
                "is_default":"1",   #是否为缺省学期：0-否，1-是
                "schedulestatus":[
	                {
		                "weeklist":[1,2,3],
		                "daylist":[147267898,147467898]  
	                }
                ]
            }，
            {
                "term_id":"2",
                "term_name":"2016-2017-2",
                "is_default":"0",   #是否为缺省学期：0-否，1-是
                "schedulestatus":[
	                {
		                "weeklist":[1,2,3],
		                "daylist":[147267898,147467898]  
	                }
                ]
            }，
            {
                "term_id":"3",
                "term_name":"2016-2017-3",
                "is_default":"0",   #是否为缺省学期：0-否，1-是
                "schedulestatus":[
	                {
		                "weeklist":[1,2,3],
		                "daylist":[147267898,147467898]  
	                }
                ]
            }
        ]
    }
}
```
#### 3.1.2 值周工作安排查询接口

> 值周工作安排查询接口用于查询指定学期中每周设置了那些值周数据，本接口调用时需要传入学期和周参数，返回的是本周值周工作列表，值周内容条数有限，不考虑分页功能
> 需要使用Token验证查询者身份

``` json
Url:        /qxy/schedule/week/term=[term]&week=[week]&token=[token]
Method:     GET
Header:     Content-type:application/json
Parameter:
    - `term`:        指定查询的学期id，term为空时查询缺省的学期
    - `week`:        指定该学期的对应周，当数据为空时，选择当前日期所在的周
Response:
    - `status`:      0->OK 
					 1->获取失败，查找的周不存在
                     10->token is invalid
                     12->token is timeout
                     13->Illegal interface calls, not power use interface
    - `scheduleweek`:        值周数据内容JSON
    - `count`:               值周数据内容的条目总数
    - `schedule_id`:         s_duty_scheduling表中自增id
    - `duty_id`:             岗位id
    - `duty_name`:           岗位名字
    - `dutyleader`:          值班领导集合tid
    - `dutyteacher`:         值班教师集合tid
```

> **返回结果示例：**

``` json
{
    "status": 0,
    "data":{
        "term_name":"2016-2017-2",
        "week":"2",
        "count":"2",
        "scheduleweek":[
            {
	            "schedule_id":"1",
				"duty_id":"221",   #值周安排对应的id
                "duty_name":"大门查询岗位",
                "dutyleader":[
                    {
                        "tid":"212",
                        "teacher_name":"张高丽"
                    },
					{
                        "tid":"221",
                        "teacher_name":"李为民"
                    }
                ],   #责任教师Tid集合
                "dutyteacher":[
                    {
                        "tid":"211",
                        "teacher_name":"高丽"
                    },
					{
                        "tid":“234”,
                        "teacher_name":"张丽"
                    },
					{
                        "tid":“213”,
                        "teacher_name":"王丽"
                    },
					{
                        "tid":“215”,
                        "teacher_name":"张高丽"
                    }
                ]
            },
            {
	            "schedule_id":"2",
				"duty_id":"221",   #值周安排对应的id
                "duty_name":"大门查询岗位",
                "dutyleader":[
                    {
                        "tid":"212",
                        "teacher_name":"张高丽"
                    },
					{
                        "tid":"221",
                        "teacher_name":"李为民"
                    }
                ],   
                "dutyteacher":[
                    {
                        "tid":"211",
                        "teacher_name":"高丽"
                    },
					{
                        "tid":“234”,
                        "teacher_name":"张丽"
                    },
					{
                        "tid":“213”,
                        "teacher_name":"王丽"
                    },
					{
                        "tid":“215”,
                        "teacher_name":"张高丽"
                    }
                ]
            }
        ]
    }
}
```


#### 3.1.3 值日工作安排查询接口

> 值日工作安排查询接口用于查询指定学期中指定日设置了那些值日数据，本接口调用时需要传入学期和日期，返回的是本日值日工作列表，值日内容条数有限，不考虑分页功能
> 需要使用Token验证查询者身份

``` json
Url:        /qxy/schedule/day/term=[term]&day=[date]&token=[token]
Method:     GET
Header:     Content-type:application/json
Parameter:
    - `term`:        指定查询的学期id，term为空时查询缺省的学期
    - `day`:         指定该学期的对应天，当数据为空时，选择当前日期所在的周
Response:
    - `status`:      0->OK 
					 1->获取失败，查找的周不存在
                     10->token is invalid
                     12->token is timeout
                     13->Illegal interface calls, not power use interface
    - `scheduleday`:         值日数据内容JSON
    - `count`:               值日数据内容的条目总数
    - `schedule_id`:         s_duty_scheduling表中自增id
    - `duty_id`:             岗位id
    - `duty_name`:           岗位名字
    - `dutyleader`:          值班领导集合tid
    - `dutyteacher`:         值班教师集合tid
```

> **返回结果示例：**

``` json
{
    "status": 0,
    "data":{
        "term_name":"2016-2017-2",
        "day":"1452908765",
        "count":"2",
        "scheduleday":[
            {
	            "schedule_id":"1",
				"duty_id":"221",   #值周安排对应的id
                "duty_name":"大门查询岗位",
                "dutyleader":[
                    {
                        "tid":"212",
                        "teacher_name":"张高丽"
                    },
					{
                        "tid":"221",
                        "teacher_name":"李为民"
                    }
                ],             
                "dutyteacher":[
                    {
                        "tid":"211",
                        "teacher_name":"高丽"
                    },
					{
                        "tid":“234”,
                        "teacher_name":"张丽"
                    },
					{
                        "tid":“213”,
                        "teacher_name":"王丽"
                    },
					{
                        "tid":“215”,
                        "teacher_name":"张高丽"
                    }
                ]
            },
            {
	            "schedule_id":"2",
				"duty_id":"221",   #值周安排对应的id
                "duty_name":"大门查询岗位",
                "dutyleader":[
                    {
                        "tid":"212",
                        "teacher_name":"张高丽"
                    },
					{
                        "tid":"221",
                        "teacher_name":"李为民"
                    }
                ],   
                "dutyteacher":[
                    {
                        "tid":"211",
                        "teacher_name":"高丽"
                    },
					{
                        "tid":“234”,
                        "teacher_name":"张丽"
                    },
					{
                        "tid":“213”,
                        "teacher_name":"王丽"
                    },
					{
                        "tid":“215”,
                        "teacher_name":"张高丽"
                    }
                ]
            }
        ]
    }
}
```
#### 3.1.4 值周(值日)工作岗位列表查询接口
> 值周（值日）工作岗位列表查询接口用于查询系统设置了那些值周岗位（值日岗位），内容条数有限，不考虑分页功能

> 值周（值日）工作岗位列表查询接口需要使用Token验证查询者身份

``` json
Url:        /qxy/duty/list/type=[type]&token=[token]
Method:     GET
Header:     Content-type:application/json
Parameter:
    - `type`:      #0-有效的数据，1-所有的数据；为空时默认返回所有有效的数据
Response:
    - `status`:   0->is OK 
                  10->token is invalid
                  12->token is timeout
                  13->Illegal interface calls, not power use interface
    - `dutylist`:     值周值日数据内容JSON
    - `count`:        值周值日数据内容的条目总数
    - `duty_name`:    岗位名称
    - `dutycontent_count`:   岗位内容条数
    - `is_use`:        #岗位状态0-停用，1-启用
    - `create_time`:    创建时间
```

> **返回结果示例：**

``` json
{
    "status": 0,
    "data":{
        "count":"2",
        "dutylist": [
            {
                "duty_id":"22",              #岗位id
                "duty_name":"学校安全检查",    #岗位内容
                "is_use":"1",                #0-停用，1-启用
                "dutycontent_count":"12",    #岗位内容条数
                "create_time":"145678945"    #创建时间
            },
            {

                "duty_id":"22",              #岗位id
                "duty_name":"学校安全检查",    #岗位内容
                "is_use":"1",                #0-停用，1-启用
                "dutycontent_count":"12",    #岗位内容条数
                "create_time":"145678945"    #创建时间
            }
        ]
    }
}
```


#### 3.1.5 值周(值日)工作岗位详情查询接口
> 值周（值日）工作岗位详情查询接口用于查询系统设置了值周岗位（值日岗位）对应的详细条目，内容条数有限，不考虑分页功能

> 值周（值日）工作岗位详情查询接口需要使用Token验证查询者身份

``` json
Url:        /qxy/duty/content/duty=[duty_id]&token=[token]
Method:     GET
Header:     Content-type:application/json
Parameter:
    - 'duty':       需要查询的工作岗位id
Response:
    - `status`:    0->is OK 
                   1->duty id 无效
                   10->token is invalid
                   12->token is timeout
                   13->Illegal interface calls, not power use interface
    - `dutycontent`:     岗位详情数据内容JSON
    - `dutycontent_id`:  岗位详细内容对应id
    - `count`:           岗位详情数据内容的条目总数
    - `content`：        岗位职责详情
    - `create_time`:     创建时间
    - `start_time`:      开始时间，格式为24小时制，如17:00
    - `end_time`:        结束时间，格式为24小时制，如18:00
```

> **返回结果示例：**

``` json
{
    "status": 0,
    "data":{
        "duty_id":"2",
        "duty_name":"值日查询岗",
        "count":"2",
        "dutycontent": [
            {
                "dutycontent_id":"22",         #岗位职责id
                "content": "学校安全检查",       #岗位职责内容
                "create_time": "1467865456",   #创建时间
                "time":{
                    "start_time":"07:00",
                    "end_time":"08:00"
                }
            },
            {
                "dutycontent_id":"23",         #岗位职责id
                "content": "学校安全检查",       #岗位职责内容
                "create_time": "1467865456",   #创建时间
                "time":{
                    "start_time":"07:00",
                    "end_time":"08:00"
                }
            }
        ]
    }
}
```

#### 3.1.6 值周(值日)工作安排新增接口
> 新增值周（值日）工作安排接口用于新增指定学期中特定周或者特定日期的新增工作安排，需要上传对应的学期，对应的周或者日期，对应的新增类型
> 
> 如果是值周类型则需要上传week、start_time、end_time；如果是值日类型，则需要上传date参数；

> 需要使用Token验证查询者身份
``` json
Url:        /qxy/schedule
Method:     POST
Header:     Content-type:application/json
Parameter:
    - 'term':         指定查询的学期id，term为空时查询缺省的学期
    - 'type':         新增岗位类型，0-值周，1-值日
    - 'week':         指定该学期的对应周
    - 'start_time':   指定该学期的对应周的开始日期
    - 'end_time':     指定该学期的对应周的结束日期
    - 'date':         指定该学期的对应日期
    - 'dutyleader':   值班领导tid集合
    - 'dutyteacher':  值班教师tid集合
    - 'duty_id':      岗位
    - 'token'：       token
示例：
#值日
{
    "token":"fcc277636dea80d3d298df9465795a875e6eb9df",
    "term_id":"1",
    "type":"1",         #0-值周 ，1-值日
    "date":"1456789643",
    "dutyleader":[212,221],               #值班领导tid集合
    "dutyteacher":[211,234,213,215],   #值班教师tid集合
    "duty_id":"221"                           #岗位id
}
#值周
{
    "token":"fcc277636dea80d3d298df9465795a875e6eb9df",
    "term_id":"1",
    "type":"0",         #0-值周 ，1-值日
    "week":"1",
    "start_time":"1458909839",
    "end_time":"1456789981",
    "dutyleader":[212,221],               #值班领导tid集合
    "dutyteacher":[211,234,213,215],   #值班教师tid集合
    "duty_id":"221"                           #岗位id
}
Response:
    - `status`: 0->is OK 
                10->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use interface
```

> **返回结果示例：**

``` json
{
    "status": "0",
    "info": "OK"
}
```
#### 3.1.7值周(值日)工作安排修改接口
> 修改接口用于修改岗位领导或岗位教师数据

> 需要使用Token验证查询者身份
``` json
Url:        /qxy/schedule
Method:     PUT
Header:     Content-type:application/json
Parameter:
    - 'dutyleader':   值班领导tid集合
    - 'dutyteacher':  值班教师tid集合
    - 'duty_id':      岗位
    - `schedule_id`:  工作安排id,对应s_duty_scheduling中自增id
    - 'token'：       token
示例：
{
    "token":"fcc277636dea80d3d298df9465795a875e6eb9df",
    "schedule_id":"1",   #工作安排id,对应s_duty_scheduling中自增id
    "dutyleader":[212,221],                #值班领导tid集合
    "dutyteacher":[211,234,213,215],   #值班教师tid集合
    "duty_id":"221"                            #岗位id
}
Response:
    - `status`: 0->is OK 
                10->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use interface
```

> **返回结果示例：**

``` json
{
    "status": "0",
    "info": "OK"
}
```
#### 3.1.8 值周(值日)工作安排删除接口
> 需要使用Token验证查询者身份
``` json
Url:        /qxy/schedule
Method:     DELETE
Header:     Content-type:application/json
Parameter:
    - `schedule_ids`:  要删除的工作安排id集合,对应s_duty_scheduling表中自增id
    - 'token'：       token
示例：
{
    "token":"fcc277636dea80d3d298df9465795a875e6eb9df",
    "schedule_ids":[1,2,3]
}
Response:
    - `status`: 0->OK
				1->删除失败，要删除的工作安排不存在 
                10->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use interface
```

> **返回结果示例：**

``` json
{
    "status": "0",
    "info": "OK"
}
```
#### 3.1.9 值周(值日)工作安排应用至其他周或天接口
> 本接口用于将值周(值日)工作安排应用至其他周或天，只能指定某周或某天，不能同时安排；
> 需要使用Token验证查询者身份
``` json
Url:        /qxy/schedule/copy
Method:     PUT
Header:     Content-type:application/json
Parameter:
    - 'dutyleader':   值班领导tid集合
    - 'dutyteacher':  值班教师tid集合
    - 'duty_id':      岗位
    - `schedule_id`:  工作安排id,对应s_duty_scheduling中自增id
    - 'token'：       token
示例：
{
    "token":"fcc277636dea80d3d298df9465795a875e6eb9df",
    "schedulelist":[
	    {
		    "schedule_id":"1",
		    "dutyleader":[212,221],
		    "dutyteacher":[213,225],
		    "duty_id":"12"
	    },
	    {
		    "schedule_id":"2",
		    "dutyleader":[212,221],
		    "dutyteacher":[213,225],
		    "duty_id":"12"
	    }
    ],
    "targettime":[
	    {
		    "weeks":[
			    {
				    "week":"1",
				    "start_time":"1434567893",
				    "end_time":"1434567893"
			    },
			    {
				    "week":"1",
				    "start_time":"1434567893",
				    "end_time":"1434567893"
			    }
		    ],
		    "days":["134562345","134564345"]
	    }
    ]
}
Response:
    - `status`: 0->is OK 
                10->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use interface
```

> **返回结果示例：**

``` json
{
    "status": "0",
    "info": "OK"
}
```

#### 3.1.10 教工标签查询接口
>详见
>7 校通讯录管理
>7.1 教工管理页面接口
>7.1.1 教工标签查询接口
#### 3.1.11 教工列表查询接口
>详见
>7 校通讯录管理
>7.1 教工管理页面接口
>7.1.2 教工列表查询接口

### 3.2 值日值周岗位相关
#### 3.2.1 值周(值日)工作岗位新增接口
> 需要使用Token验证查询者身份
``` json
Url:        /qxy/duty
Method:     POST
Header:     Content-type:application/json
Parameter:
    - `duty_name`:   岗位名字
    - 'token'：      token
示例：
{
	"token":"fcc277636dea80d3d298df9465795a875e6eb9df",
    "duty_name": "日常考核岗"
}
Response:
    - `status`: 0->OK 
                10->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use interface
```

> **返回结果示例：**

``` json
{
    "status": "0",
    "info": "OK"
}
```

#### 3.2.2 值周(值日)工作岗位修改及停用(启用)接口
> 修改只能单个修改，停用/启用可以批量操作；
> 需要使用Token验证
> 查询者身份
``` json
Url:        /qxy/duty
Method:     PUT
Header:     Content-type:application/json
Parameter:
    - `duty_id`:     岗位id
    - `duty_name`:   岗位名字
    - `is_use`:      是否启用0-停用，1-启用
    - `token`：      token
    - `dutylist`:    岗位列表json
示例：
{
	"token":"fcc277636dea80d3d298df9465795a875e6eb9df",
    "dutylist":[
	    {
		    "duty_id":"1",
		    "duty_name":"日常考核岗"，
		    "is_use":"1"
	    }
    ]
}
Response:
    - `status`: 0->OK 
				1->修改失败，名字已存在
				2->停用/启用失败，岗位不存在 
                10->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use interface
```

> **返回结果示例：**

``` json
{
    "status": "0",
    "info": "OK"
}
```

#### 3.2.3 值周(值日)工作岗位删除接口
>删除之前需要检测是否还包含有岗位规则，没有关联子规则才被允许删除
> 需要使用Token验证查询者身份
``` json
Url:        /qxy/duty
Method:     DELETE
Header:     Content-type:application/json
Parameter:
    - `duty_id`:     岗位id
    - `duty_name`:   岗位名字
    - `is_use`:      是否启用0-停用，1-启用
    - 'token'：      token
示例：
{
	"token":"fcc277636dea80d3d298df9465795a875e6eb9df",
    "duty_ids":[1,2,3]       #要删除的岗位id集合
}
Response:
    - `status`: 0->OK 
				1->删除失败，要删除的岗位包含了子规则
				2->删除失败，岗位id不存在
                10->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use interface
```

> **返回结果示例：**

``` json
{
    "status": "0",
    "info": "OK"
}
```


### 3.3 值日值周岗位详情管理
#### 3.3.1 值周(值日)工作岗位详情新增接口
> 需要使用Token验证查询者身份
``` json
Url:        /qxy/duty/content
Method:     POST
Header:     Content-type:application/json
Parameter:
    - `duty_id`:     岗位id
    - `content`:     岗位职责内容
    - `time`:        岗位职责时间
    - `start_time`:  开始时间，24小时制，如07:00
    - `end_time`:    结束时间，24小时制，如08:00
    - `token`：      token
示例：
{
	"token":"fcc277636dea80d3d298df9465795a875e6eb9df",
    "duty_id":"1",
    "content":"检查校门学生入学情况",
    "time":{
	    "start_time":"07:00",
	    "end_time":"08:00"
    }
}
Response:
    - `status`: 0->OK 
                10->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use interface
```

> **返回结果示例：**

``` json
{
    "status": "0",
    "info": "OK"
}
```

#### 3.3.2 值周(值日)工作岗位详情修改接口
> 需要使用Token验证查询者身份
``` json
Url:        /qxy/duty/content
Method:     PUT
Header:     Content-type:application/json
Parameter:
    - `dutycontent_id`:     岗位id
    - `content`:     岗位职责内容
    - `start_time`:  开始时间，24小时制，如07:00
    - `end_time`:    结束时间，24小时制，如08:00
    - `token`：      token
示例：
{
	"token":"fcc277636dea80d3d298df9465795a875e6eb9df",
    "dutycontent_id":"1",
    "content":"检查校门学生入学情况",
    "time":{
	    "start_time":"07:00",
	    "end_time":"08:00"
    }
}
Response:
    - `status`: 0->OK 
                1->修改失败，岗位规则不存在
                10->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use interface
```

> **返回结果示例：**

``` json
{
    "status": "0",
    "info": "OK"
}
```

#### 3.3.3 值周(值日)工作岗位详情删除接口
> 需要使用Token验证查询者身份
``` json
Url:        /qxy/duty/content
Method:     DELETE
Header:     Content-type:application/json
Parameter:
    - `dutycontent_id`:     岗位详情id
    - `token`：             token
示例：
{
	"token":"fcc277636dea80d3d298df9465795a875e6eb9df",
    "dutycontentlist":[1,2,3,4]
}
Response:
    - `status`: 0->OK 
                1->删除失败，删除的岗位详情不存在
                10->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use interface
```
> **返回结果示例：**
``` json
{
    "status": "0",
    "info": "OK"
}
```
### 3.4 工作流程管理
#### 3.4.1 我提交的事项查询接口

> 我提交的事项查询接口用于查询我发起（或者指定老师）发起的工作流事项列表，接口使用tid来查询具体教师发布的工作流。工作流目前分为三类（请假，活动，保修）
>
> 需要使用Token验证查询者身份
``` json
Url:        /qxy/myapplication/teacher=[tid]&token=[token]
Method:     GET
Header:     Content-type:application/json
Parameter:
        - tid : 需要查询的教师ID，没有传参数的查询本人（token中包括）
Response:
        - `status`: 0->is OK 
                    10->token is invalid
                    12->token is timeout
                    13->Illegal interface calls, not power use interface
		- `myapplication`:            我提交的事项json
		- `approval_information_id`:  我提交事项的id
		- `type`:                     #0-请假；1-活动；2-保修
		- `oatags_id`:                oa标签id
		- `oatags_name`:              oa标签名称
		- `content`:                  待审批内容
		- `result`:   该条申请的审批结果0-待审核；1-已审核通过；2-审核不通过
		- `resultinfo`:               审核信息json
		- `auditresult`： 审核人审核结果0-待审核；1-已审核通过；2-审核不通过
```

> **返回结果示例：**

``` json
{
    "status": 0,
    "data":{
        "count":"2",
        "myapplication": [
            {
                "approval_information_id":"222", 
                "type":"0",   #0-请假；1-活动；2-保修
                "oatags_id":"2",  
                "oatags_name":"病假",      #流程模版名称
                "content":"待审批内容",
                "create_time":"2132323",  #流程创建时间
                "result":"0",   #0-待审核；1-已审核通过；2-审核不通过
                "resultinfo":[
	                {
		                "tid":"123",
		                "teacher_name":"张三",
		                "auditresult":"0" #0-待审核；1-已审核通过；2-审核不通过
	                },
	                {
		                "tid":"124",
		                "teacher_name":"张四",
		                "auditresult":"1" #0-待审核；1-已审核通过；2-审核不通过
	                }
                ]
            },
            {
                "approval_information_id":"223", 
                "type":"0",   #0-请假；1-活动；2-保修
                "oatags_id":"2",  
                "oatags_name":"病假",      #流程模版名称
                "content":"审批内容",
                "create_time":"2132323",  #流程创建时间
                "result":"0",   #0-待审核；1-已审核通过；2-审核不通过
                "resultinfo":[
	                {
		                "tid":"123",
		                "teacher_name":"张三",
		                "auditresult":"0" #0-待审核；1-已审核通过；2-审核不通过
	                },
	                {
		                "tid":"124",
		                "teacher_name":"张四",
		                "auditresult":"1" #0-待审核；1-已审核通过；2-审核不通过
	                }
                ]
            }
        ]
    }
}
```

#### 3.4.2 我提交的事项新增接口
> 需要使用Token验证查询者身份
``` json
Url:        /qxy/myapplication
Method:     POST
Header:     Content-type:application/json
Parameter:
        - `token`:        token
        - `tid`:          申请人tid
        - `type`:         类型#0-请假；1-活动；2-保修
        - `oatags_id`:    流程事项模板id
        - `content`:      我提交的申请内容
示例
{
	"token":"fcc277636dea80d3d298df9465795a875e6eb9df"
    "tid": "223",             #申请人
    "type":"0",               #0-请假；1-活动；2-保修
    "oatags_id":"2",  
    "content":"待审批内容",
}
Response:
    - `status`: 0->is OK 
                10->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use interface
```

> **返回结果示例：**

``` json
{
    "status": "0",
    "info": "OK"
}
```
#### 3.4.3 我提交的事项删除接口
> 需要使用Token验证查询者身份
``` json
Url:        /qxy/myapplication
Method:     DELETE
Header:     Content-type:application/json
Parameter:
        - `token`:        token
        - `approval_information_id`:     提交事项申请id 
示例
{
	"token":"fcc277636dea80d3d298df9465795a875e6eb9df"
    "approval_information_ids":[22,23,24]     #申请人
}
Response:
    - `status`: 0->is OK 
                1->删除失败，提交的事项不存在
                10->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use interface
```

> **返回结果示例：**

``` json
{
    "status": "0",
    "info": "OK"
}
```
#### 3.4.4 我的审批事项查询接口
> 我的审批查询接口用于查询我参与进行的审批工作流列表，接口使用tid来查询具体教师发布的工作流。工作流目前分为三类（请假，活动，保修）。审批列表通过查询数据库oa_examine_result的内容来形成结果。其中仅仅显示tid对应的数据，并且该数据还是生效的数据。（仅显示表中rule_status字段为0的数据内容，为1则表示该规则以及失效，为9时该审批请求已经被删除）
>
> 需要使用Token验证查询者身份
``` json
Url:        /qxy/myaudit/teacher=[tid]&token=[token]
Method:     GET
Header:     Content-type:application/json
Parameter:
        - tid : 需要查询的教师ID，没有传参数的查询本人（token中包括）
Response:
        - `status`: 0->is OK 
                    10->token is invalid
                    12->token is timeout
                    13->Illegal interface calls, not power use interface
```

> **返回结果示例：**

``` json
{
    "status": 0,
    "data":{
        "count":"2",
        "myaudit": [
            {
                "approval_information_id":"222",  #对应的用户发起的审批id
                "myaudit_id":"23"，               #key,审批表的id
                "type":"0",   #0-请假；1-活动；2-保修
                "content":"审批内容"，
                "create_time":"2132323",  #申请流程时间
                "result":"0",   #审批结果
                "oatags_id":"1",   #应用的流程模版
                "oatags_name":"病假",   #应用的流程模版
                "oarule_status":"0",   #0-未完成；1-完成
                "tid":"23",  #发起人的tid
                "tname":"张三",  #发起人的名字
                "resultinfo":[
	                {
		                "tid":"123",
		                "teacher_name":"张三",
		                "auditresult":"0" #0-待审核；1-已审核通过；2-审核不通过
	                },
	                {
		                "tid":"124",
		                "teacher_name":"张四",
		                "auditresult":"1" #0-待审核；1-已审核通过；2-审核不通过
	                }
                ]
            },
            {
                "approval_information_id":"223",  #对应的用户发起的审批id
                "myaudit_id":"23"，               #key,审批表的id
                "type":"0",   #0-请假；1-活动；2-保修
                "content":"审批内容"，
                "create_time":"2132323",  #申请流程时间
                "result":"0",   #审批结果
                "oatags_id":"1",   #应用的流程模版
                "oatags_name":"病假",   #应用的流程模版
                "oarule_status":"0",   #0-未完成；1-完成
                "tid":"23",  #发起人的tid
                "tname":"张三",  #发起人的名字
                "resultinfo":[
	                {
		                "tid":"123",
		                "teacher_name":"张三",
		                "auditresult":"0" #0-待审核；1-已审核通过；2-审核不通过
	                },
	                {
		                "tid":"124",
		                "teacher_name":"张四",
		                "auditresult":"1" #0-待审核；1-已审核通过；2-审核不通过
	                }
                ]
            }
        ]
    }
}
```

#### 3.4.5 我的审批驳回(同意)操作接口
> 我的审批状态修改接口用于设置审批结果，可以通过type通过审批或者拒绝审批，通过更新oa_examine_result表中的审批结果字段（result）及审批反馈字段（content）来计算审批下一步的流程。（计算方法是根据oa_examine_result中的aid（id主键）查找rule_id，并通过rule_id在oa_rule表中找到对应的规则（一人通过还是全部通过），“一人通过”的话需要根据oa_examine_result表中approval_information_id和rule_id将其他审批人的rule_status都改成1（表示本层审批完成），然后找到oa_rule表中下一级的审批规则
（查找oa_rule表中serial_number值比现在值大一位的值）并将tids字段中的教师数据（多个教师tid以逗号分隔）展开，为下一层审批的每个老师形成一条审批数据（插入oa_examine_result表）。如果是“多人通过”则需要查询本规则下（oa_examine_result表中approval_information_id和rule_id相同的几条纪录）是否都完成审批，都完成了审批即可按上面的方法找到oa_rule表中下一级的审批规则
（查找oa_rule表中serial_number值比现在值大一位的值）并将tids字段中的教师数据（多个教师tid以逗号分隔）展开，为下一层审批的每个老师形成一条审批数据（插入oa_examine_result表）。
>
> 如果提交的拒绝审批，则通过approval_information_id修改oa_examine_result中所有的审批项的rule_status为2（被拒绝），并将工作流表（oa_examine_information）标记改审批结束，状态为拒绝。
>
> 需要使用Token验证查询者身份

``` json
Url:        /qxy/myaudit/set
Method:     PUT
Header:     Content-type:application/json
Parameter:
    - `sid` : 学校sid
    - `token`: 用户token
示例：
{
    "myaudit_id":"22",       #我的审批表中的key
    "result":"1",            #0-待审核；1-已审核通过；2-审核不通过
    "content":"审批内容",
    "token":"2222eee"
}
            
Response:
    - `status`: 0->OK 
                10->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use interface
```

> **返回结果示例：**

``` json
{
    "status": "0",
    "info": "OK"
}
```

### 3.5 工作流程模板设置
#### 3.5.1 工作流程事项模板查询接口
> 学校工作流查询接口用于查询当前设置的主要工作流（oa_tags和oa_rule，关联表，子父表），没有暂停功能，只能能删除修改（如果规则模板已经被引用，则不能操作）新增，只能查询token对应的sid下的工作流，不能跨学校查询
>
> 需要使用Token验证查询者身份
``` json
Url:        /qxy/oatags/token=[token]
Method:     GET
Header:     Content-type:application/json
Parameter:
        - 无
Response:
        - `status`: 0->OK 
                    10->token is invalid
                    12->token is timeout
                    13->Illegal interface calls, not power use interface
```

> **返回结果示例：**

``` json
{
    "status": 0,
    "data":{
        "count":"2",
        "oatags": [
            {
                "oatags_id":"222",    #流程模板id ，key
                "oatags_name":"",     #流程模版名称
                "type":"0",           #0-请假；1-活动；2-保修
                "cycle":"23",         #审核周期时间
                "oarule_count":"4",    #流程规则数量
                "create_time":"1456789654"    #流程规则数量
            },
            {
                "oatags_id":"223",    #流程模板id ，key
                "oatags_name":"",     #流程模版名称
                "type":"0",           #0-请假；1-活动；2-保修
                "cycle":"23",         #审核周期时间
                "oarule_count":"4",    #流程规则数量
                "create_time":"1456789654"    #流程规则数量
            }
        ]
    }
}
```


#### 3.5.2 工作流程事项模板新增接口
> 需要使用Token验证查询者身份
``` json
Url:        /qxy/oatags
Method:     POST
Header:     Content-type:application/json
Parameter:
        - 'token':        token 
        - "oarule_ids":      #流程规则id集合
示例：
{
    "oatags_name":"1士大夫",     #流程模版名称
    "type":"0",           #0-请假；1-活动；2-保修
    "cycle":"23",         #审核周期时间
    "oarule_ids":[1,2], #流程规则id集合   
    "token":"2222eee"   
}        
Response:
    - `status`: 0->OK 
                10->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use interface
```

> **返回结果示例：**

``` json
{
    "status": "0",
    "info": "OK"
}
```

#### 3.5.3 工作流程事项模板修改接口
> 流程事项模板被应用后不能删除修改
> 需要使用Token验证查询者身份
``` json
Url:        /qxy/oatags
Method:     PUT
Header:     Content-type:application/json
Parameter:
        - 'token':        token 
        - "oarule_ids":      #流程规则id集合
        - "oatags_id":      #流程模板id
示例：
{
    "oatags_id":"1",         #流程模版id
    "oatags_name":"测试",     #流程模版名称
    "type":"0",              #0-请假；1-活动；2-保修
    "cycle":"23",            #审核周期时间
    "oarule_ids":[1,2],   #流程规则id集合
    "token":"2222eee"         
}        
Response:
    - `status`: 0->OK 
                1->修改失败，流程模板已被使用
                10->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use interface
```

> **返回结果示例：**

``` json
{
    "status": "0",
    "info": "OK"
}
```
#### 3.5.4 工作流程事项模板删除接口
> 流程事项模板被应用后不能删除修改
> 需要使用Token验证查询者身份
``` json
Url:        /qxy/oatags
Method:     DELETE
Header:     Content-type:application/json
Parameter:
        - 'token':        token 
        - "oatags_id":      #流程模板id
示例：
{
    "token":"2222eee", 
    "oatags_ids":[1,2]   #待删除的流程模板id集合      
}        
Response:
    - `status`: 0->OK 
                1->删除失败，流程模板已被使用
                10->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use interface
```

> **返回结果示例：**

``` json
{
    "status": "0",
    "info": "OK"
}
```
### 3.6 工作流程模板规则相关
#### 3.6.1 工作流程事项模板规则查询接口
> 学校工作流事项模板规则详情查询接口用于查询当前设置的主要工作流（oa_tags和oa_rule，关联表，子父表），没有暂停功能，能删除修改（如果规则模板已经被引用，则不能操作）和新增，只能查询token对应的sid下的工作流，不能跨学校查询
>
> 需要使用Token验证查询者身份
``` json
Url:        /qxy/oarule/oatags=[oatags_id]&page=[page]&size=[size]&token=[token]
Method:     GET
Header:     Content-type:application/json
Parameter:
        - 'oatags':     规则模板id,传入可获取特定模板下的规则，如果不传则为所有规则列表
        - 'page':       获取分页数，不传值则默认为0返回所有数据
        - 'size':       每页数据量，不传值则默认每页返回12条数据
Response:
        - `status`: 0->OK 
                    10->token is invalid
                    12->token is timeout
                    13->Illegal interface calls, not power use interface
```

> **返回结果示例：**

``` json
{
    "status": 0,
    "data":{
        "page":"2",
        "size":"12",
        "count":"22",
        "oarule": [
            {
                "oarule_id":"222",    #流程模板id ，key
                "oarule_name":"",     #流程模版名称
                "oatags_id":"222",    #流程模板id ，key
                "oatags_name":"",     #流程模版名称
                "serial_number":"1",  #执行序号
                "adopt_type":"1",    #规则通过方式0-单人通过，1-所有人通过
                "tids":[1,2,3]       #审批人的tid集合
                "create_time":"1456789654"    #创建时间
            },
            {
                "oarule_id":"222",    #流程模板id ，key
                "oarule_name":"",     #流程模版名称
                "oatags_id":"222",    #流程模板id ，key
                "oatags_name":"",     #流程模版名称
                "serial_number":"1",  #执行序号
                "adopt_type":"1",    #规则通过方式0-单人通过，1-所有人通过
                "tids":[1,2,3]   #审批人的tid集合
                "create_time":"1456789654"    #创建时间
            }
        ]
    }
}
```


#### 3.6.2 工作流程事项模板规则新增接口

> 学校工作流事项模板规则详情查询接口用于查询当前设置的主要工作流（oa_tags和oa_rule，关联表，子父表），没有暂停功能，能删除修改（如果规则模板已经被引用，则不能操作）和新增，只能查询token对应的sid下的工作流，不能跨学校查询
>
> 需要使用Token验证查询者身份
``` json
Url:        /qxy/oarule
Method:     POST
Header:     Content-type:application/json
Parameter:
        - 'token':      token
示例：
{
    "token":"2222eee", 
    "oatags_id":"1",   #流程模板id
    "oarule_name":"班主任审批",
    "serial_number":"1",  #执行序号
    "adopt_type":"1",    #规则通过方式0-单人通过，1-所有人通过
}    
Response:
        - `status`: 0->OK 
                    10->token is invalid
                    12->token is timeout
                    13->Illegal interface calls, not power use interface
```

> **返回结果示例：**

``` json
{
    "status": "0",
    "info": "OK"
}
```

#### 3.6.3 工作流程事项模板规则修改及指定审批人接口
> 学校工作流事项模板规则详情查询接口用于查询当前设置的主要工作流（oa_tags和oa_rule，关联表，子父表），没有暂停功能，能删除修改（如果规则模板已经被引用，则不能操作）和新增，只能查询token对应的sid下的工作流，不能跨学校查询
>可以修改规则详情和指定审批人，如果规则被使用则不能修改和删除
> 需要使用Token验证查询者身份
``` json
Url:        /qxy/oarule
Method:     PUT
Header:     Content-type:application/json
Parameter:
        - 'oarule_id':     模板规则id
        - 'token':      token
示例：
{
    "token":"2222eee", 
    "oarule_id":"1",   #流程模板规则id
    "oarule_name":"班主任流程",   #流程模板规则名称
    "serial_number":"1",  #执行序号
    "adopt_type":"1",    #规则通过方式0-单人通过，1-所有人通过
    "tids":[1,2,3]   #指定审批人的tid集合
}    
Response:
        - `status`: 0->OK 
                    10->token is invalid
                    12->token is timeout
                    13->Illegal interface calls, not power use interface
```

> **返回结果示例：**

``` json
{
    "status": "0",
    "info": "OK"
}
```
#### 3.6.4 工作流程事项模板规则删除接口
> 学校工作流事项模板规则详情查询接口用于查询当前设置的主要工作流（oa_tags和oa_rule，关联表，子父表），没有暂停功能，能删除修改（如果规则模板已经被引用，则不能操作）和新增，只能查询token对应的sid下的工作流，不能跨学校查询
>可以修改规则详情和指定审批人，如果规则被使用则不能修改和删除
> 需要使用Token验证查询者身份
``` json
Url:        /qxy/oarule
Method:     DELETE
Header:     Content-type:application/json
Parameter:
        - 'oarule_ids':     模板规则id集合
        - 'token':      token
示例：
{
    "token":"2222eee", 
    "oarule_idS":[1,2,3]   #流程模板规则id集合
}    
Response:
        - `status`: 0->OK 
                    10->token is invalid
                    12->token is timeout
                    13->Illegal interface calls, not power use interface
```

> **返回结果示例：**

``` json
{
    "status": "0",
    "info": "OK"
}
```
#### 3.6.5 教工标签查询接口
>详见
>7 校通讯录管理
>7.1 教工管理页面接口
>7.1.1 教工标签查询接口
#### 3.6.6 教工列表查询接口
>详见
>7 校通讯录管理
>7.1 教工管理页面接口
>7.1.2 教工列表查询接口













