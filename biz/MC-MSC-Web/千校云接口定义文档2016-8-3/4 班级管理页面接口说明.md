[toc]

## 4 班级管理页面接口说明

@(千校云)

> 标签： 接口 班级管理

---

### 文档更新说明
> 更新时间：2016-08-01

### 页面说明
 > 班级管理功能包括以下两个页面为班级列表管理页面，以及班级学生管理页面，命名为：班级管理，班级学生。班级管理页面可以进入班级详情页面，班级详情页面由班级课程页面和班级学生页面组成。其中班级课程页面能指定班级开设的课程和任课老师。班级学生页面可以查看本班级的学生信息和学生对应的家长信息。班级学生页面是整个学校学生数据的调整页面，可以实现学生调班级，删除学生，新增学生等功能
 
 > 班级管理页面列出了不同学期的全校班级数据，并能实现分页显示和班级搜索功能，还可以根据班级对应的年纪名称进行搜索
 
 > 班级详情的班级课程页面列出了班级开设的课程和任课老师的关联关系，可以指定开设的课程以及课程对应的任课老师
 
 > 班级详情的班级学生页面列出了本班级的全部学生数据，可以对学生数据进行新增、修改、删除
 
 > 班级学生页面类似与教工组织页面，列出了全校班级情况和每个班级的学生数据情况。该页面可以对班级学生进行修改数据，新增学生，删除学生，以及移动学生操作。

### 4.1 班级管理页面接口
####4.1.1 学校学期年级班级查询接口（通用）
>详见
>9 系统设置
>9.3 班级设定页面接口
>9.3.1 学校学期年级班级查询接口（通用）

####4.1.2 班级列表查询接口
> 班级查询接口获取相关学期下的班级
> 班级查询接口需要使用Token验证查询者身份

``` json
Url:        /qxy/classlist/term=[term_id]&grade=[grade_id]&class=[cid]&page=[page]&size=[size]&teacher=[tid]&token=[token]
Method:     GET
Header:     Content-type:application/json
Parameter:
    - `term`:   查询的学期的id，学期数据为必填数据，当学期为空时，缺省返回缺省学期数据（即is_default为1）
    - `grade`:  查询的年级标签id
    - `class`： 特定的班级的cid，cid为空返回所有数据
    - `page`:   班级分页数据，page＝0时返回全部班级数据
    - `size`:   每页显示班级数据，size=0或为空时，默认返回每页显示12条数据
    - `teacher`:    可选参数，传tid查询该教师的班级列表，不传则返回全部班级
Response:
    - `status`： 0->OK 
                1->学期数据不正确
                10->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use nterface
    - `class`:   班级内容JSON
    - `term`:    当前学期
    - `count`:   班级总数
    - `course_count`:班级课程数量
    - `student_count`:班级学生人数
```

> **返回结果示例：**

``` json
{
    "status": 0,
    "data":{
        "term":"2016-2017-1",
        "tid":"34",        #可选参数
        "page":"1",
        "size":"12",      
        "count":"2",       #班级总数
        "class": [
            {
                "cid":"234",
                "class_name":"高三一班",
                "leader_name":"张老师",    #班主任姓名
                "c_course":"4",           #班级课程数量
                "c_student":"23",         #班级学生人数
            },
            {
                "cid":"234",
                "class_name":"高三一班",
                "leader_name":"张老师",        #班主任姓名
                "course_count":"4",           #班级课程数量
                "student_count":"23",         #班级学生人数
            }
         ]
    }
}
```

### 4.2 班级课程页面接口
####4.2.1 班级课程查询接口
> 班级查询接口需要使用Token验证查询者身份

``` json
Url:        /qxy/class/course/cid=[cid]&token=[token]
Method:     GET
Header:     Content-type:application/json
Parameter:
    - `cid`：    班级id
Response:
    - `status`： 0->OK 
                1->班级不存在
                10->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use nterface
    - `course`:  班级课程内容JSON
    - `count`:   课程总数
    
```

> **返回结果示例：**

``` json
{
    "status": 0,
    "data":{
        "cid":"234",
        "class_name":"高三一班",      #班级名字
        "leader_name":"张老师",      #班主任姓名
        "count":"2",         
        "course": [
            {
                "course_id":"11",         
                "course_name":"语文",  
                "tid":"234",
                "teacher_name":"张三",
                "phone":"15232523256",
                "email":"1@1.com",
                "is_leader":"1"        #0-不是班主任；1-班主任        
            }，
            {
                "course_id":"11",
                "course_name":"语文",       
            }，
        ]
    }
}
```


####4.2.2 学校课程查询接口
>详见
>9 系统设置
>9.2 课程管理页面接口
>9.2.1 学校课程查询接口

####4.2.3 班级课程新增接口
> 需要使用Token验证查询者身份
``` json
Url:        /qxy/class/course
Method:     POST
Header:     Content-type:application/json
Parameter:
    - `course_id`:  课程id
    - `cid`：        班级id
    - 'token'：     token
示例：
{
    "token":"fcc277636dea80d3d298df9465795a875e6eb9df",
    "cid":"234",
    "course_id":"21"
}
Response:
    - `status`： 0->OK 
                1->课程不存在
                2->班级不存在
                10->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use nterface
```

> **返回结果示例：**

``` json
{
    "status": "0",
    "info": "OK"
}
```

####4.2.4 班级课程修改接口

> 需要使用Token验证查询者身份
``` json
Url:        /qxy/class/course
Method:     PUT
Header:     Content-type:application/json
Parameter:
    - `course_id`:   原课程id
    - `target`:      选中的课程id
    - `cid`：        班级id
    - 'token'：      token
示例：
{
    "token":"fcc277636dea80d3d298df9465795a875e6eb9df",
    "cid":"234",
    "course_id":"21",
    "target":"22"
}
Response:
    - `status`： 0->OK 
                1->课程不存在
                2->班级不存在
                10->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use nterface
```

> **返回结果示例：**

``` json
{
    "status": "0",
    "info": "OK"
}
```
####4.2.5 班级课程教师指定及修改接口
> 需要使用Token验证查询者身份
``` json
Url:        /qxy/class/teacher
Method:     PUT
Header:     Content-type:application/json
Parameter:
    - `tid`:         原教师id
    - `target`:      选中的教师id
    - `course_id`:   课程id
    - `cid`：        班级id
    - 'token'：      token
示例：
{
    "token":"fcc277636dea80d3d298df9465795a875e6eb9df",
    "cid":"234",
    "course_id":"21",
    "tid":"22",
    "target":"23"
}
Response:
    - `status`： 0->OK 
                1->教师不存在
                2->班级不存在
                10->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use nterface
```

> **返回结果示例：**

``` json
{
    "status": "0",
    "info": "OK"
}
```

####4.2.6 班级课程删除接口

> 需要使用Token验证查询者身份
``` json
Url:        /qxy/class/course
Method:     PUT
Header:     Content-type:application/json
Parameter:
    - `course_id`:   课程id
    - `cid`：        班级id
    - 'token'：      token
示例：
{
    "token":"fcc277636dea80d3d298df9465795a875e6eb9df",
    "cid":"234",
    "course_id":"21"
}
Response:
    - `status`： 0->OK 
                1->课程不存在
                2->班级不存在
                10->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use nterface
```

> **返回结果示例：**

``` json
{
    "status": "0",
    "info": "OK"
}
```

####4.2.8 教工标签查询接口
引用教工管理中教工标签查询接口
7.1.1 教工标签查询接口

####4.2.9 教工列表查询接口
引用教工管理中教工列表查询接口
7.1.2 教工列表查询接口

### 4.3 班级学生管理
####4.3.1 班级学生(家长)列表查询接口
> 返回某班级下的学生列表，显示家长学生关联表中is_default为1的家长

> 需要使用Token验证查询者身份

``` json
Url:        /qxy/class/student/list/cid=[cid]&page=[page]&size=[size]&token=[token]
Method:     GET
Header:     Content-type:application/json
Parameter:
    - `cid`:    班级id
    - `page`:   分页编号，分页为0或者空时，返回全部数据
    - `size`:   每页数据条数，为0或空时，默认返回12条数据
Response:
    - `status`：0->token is OK 
                11->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use interface
    - `student`: 学生内容JSON
    - `count`:   学生总数
```

> **返回结果示例：**

``` json
{
    "status": 0,
    "data":{
        "cid":"20",
        "class_name":"高一三班",
        "leader_name":"张三",                     #班主任姓名
        "page":"1",
        "size":"12",
        "count":"200",
        "student":[
                {   
                    "student_id": "3434",
                    "student_name": "张高丽",          #学生名字
                    "number": "234324242",         #学号
                    "phone": "13415235254",        #手机号
                    "parent_id": "12",           
                    "parent_name": "张强",            #家长姓名
                    "is_use":"1"                  #0-停用；1-启用
                },
                {   
                    "student_id": "3434",
                    "student_name": "张高丽",          #学生名字
                    "number": "234324242",         #学号
                    "phone": "13415235254",        #手机号
                    "parent_id": "12",           
                    "parent_name": "张强",            #家长姓名
                    "is_use":"1" 
                },
                {   
                    "student_id": "3434",
                    "student_name": "张高丽",          #学生名字
                    "number": "234324242",         #学号
                    "phone": "13415235254",        #手机号
                    "parent_id": "12",           
                    "parent_name": "张强",            #家长姓名
                    "is_use":"1" 
                }
            ]
        }
    }
}
```

####4.3.2 班级学生(家长)搜索接口
> 需要使用Token验证查询者身份

``` json
Url:        /qxy/class/student/search/cid=[cid]&number=[number]&token=[token]
Method:     GET
Header:     Content-type:application/json
Parameter:
    - `cid`:      班级id
    - `number`:   学生学号
Response:
    - `status`：0->token is OK 
                11->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use interface
    - `student`: 学生内容JSON

```

> **返回结果示例：**

``` json
{
    "status": 0,
    "data":{
        "cid":"20",
        "class_name":"高一三班",
        "leader_name":"张三",                     #班主任姓名
        "number":"1225122",
        "student":[
                {   
                    "student_id": "3434",
                    "student_name": "张高丽",          #学生名字
                    "number": "234324242",         #学号
                    "phone": "13415235254",        #手机号
                    "parent_id": "12",           
                    "parent_name": "张强",            #家长姓名
                    "is_use":"1"                  #0-停用；1-启用
                }
            ]
        }
    }
}
```
####4.3.3 班级学生(家长)信息查询接口

> 学生信息详情查询接口返回当时学期的特定班级的特定学生详情数据

> 班级学生查询接口需要使用Token验证查询者身份

``` json
Url:        /qxy/class/student/info/cid=[cid]&student=[student_id]&token=[token]
Method:     GET
Header:     Content-type:application/json
Parameter:
    - `student_id`:    查询的学生id
    - `cid`:           查询学生的班级id
Response:
    - `status`：       0->token is OK 
                       1->无效的student_id
                       11->token is invalid
                       12->token is timeout
                       13->Illegal interface calls, not power use interface
    - `parentinfo`:    学生家长内容JSON
```

> **返回结果示例：**

``` json
{
    "status": 0,
    "data":{
        "student_id": "3434",
        "student_name": "张高丽",              #学生姓名
        "date_of_birth": "1465228800",     #出生日期
        "student_type": "分配",             #学生类别
        "number": "1465228800",             #学号
        "date_of_school": "234324242",      #入学日期
        "residence_type": "13987723451",    #户口类型
        "residence_address": "新春一街12号",  #户口地址
        "parentinfo":[
	        {
		        "parent_id":"123",
		        "parent_name":"张强"，         #家长姓名
		        "phone":"15235256525"，
		        "email":"1523@.com"，
		        "work_unit":"咚咚咚某某公司"，       #工作单位
		        "position":"工程师"，      #职位
		        "is_use":"1",            #是否启用（0-停用；1-正常；）
		        "role":"1",              #家长角色（1-爸爸;2-妈妈;3-爷爷;4-奶奶;5-其他）
		        "is_default":"1"        #是否为主家长（0-否；1-是；）
	        },
	        {
		        "parent_id":"123",
		        "parent_name":"张强"，
		        "phone":"15235256525"，
		        "email":"15223@.com"，
		        "work_unit":"张强"，
		        "position":"工程师"，
		        "is_use":"1",            #是否启用（0-停用；1-正常；）
		        "role":"1",              #家长角色（1-爸爸;2-妈妈;3-爷爷;4-奶奶;5-其他）
		        "is_default":"1"        #是否为主家长（0-否；1-是；）
	        }
        ]
        
    }
}
```


####4.3.4 班级学生(家长)新增接口
>学生、家长手机号和邮箱、学号在系统中均是唯一的，不能重复，添加时需检查存在时不允许添加
> 需要使用Token验证查询者身份
``` json
Url:        /qxy/class/student
Method:     POST
Header:     Content-type:application/json
Parameter:
    - `cid`：        班级id
    - 'token'：      token
    - 详见示例
示例：
{
    "token":"fcc277636dea80d3d298df9465795a875e6eb9df",
    "cid":"234",
    "student_name": "张高丽",              #学生姓名
    "date_of_birth": "1465228800",     #出生日期
    "student_type": "分配",             #学生类别
    "number": "1465228800",             #学号
    "date_of_school": "234324242",      #入学日期
    "residence_type": "13987723451",    #户口类型
    "residence_address": "新春一街12号",  #户口地址
    "parentinfo":[
	     {
	      "parent_name":"张强",         #家长姓名
	      "phone":"15235256525",
	      "email":"1523@.com",
	      "work_unit":"咚咚咚某某公司",       #工作单位
	      "position":"工程师",              #职位
	      "role":"1",                       #家长角色（1-爸爸;2-妈妈;3-爷爷;4-奶奶;5-其他）
	      "is_default":"1"                  #是否为主家长（0-否；1-是；）
	     },
	     {
	      "parent_name":"张强"，
	      "phone":"15235256525",
	      "email":"15223@.com",
	      "work_unit":"张强",
	      "position":"工程师",
	      "role":"1",              #家长角色（1-爸爸;2-妈妈;3-爷爷;4-奶奶;5-其他）
	      "is_default":"0"         #是否为主家长（0-否；1-是；）
	     }
  ]
}
Response:
    - `status`： 0->OK 
                1->班级不存在
                2->该手机号或邮箱已存
                10->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use nterface
```

> **返回结果示例：**

``` json
{
    "status": "0",
    "info": "OK"
}
```
####4.3.5 班级学生(家长)修改接口
> 需要使用Token验证查询者身份
``` json
Url:        /qxy/class/student
Method:     PUT
Header:     Content-type:application/json
Parameter:
    - `cid`:         班级id
    - `student_id`： 学生id
    - 'token'：      token
    - 详见示例
示例：
{
    "token":"fcc277636dea80d3d298df9465795a875e6eb9df",
    "cid":"234",
    "student_id": "111",               #学生id
    "student_name": "张高丽",           #学生姓名
    "date_of_birth": "1465228800",     #出生日期
    "student_type": "分配",             #学生类别
    "number": "1465228800",             #学号
    "date_of_school": "234324242",      #入学日期
    "residence_type": "13987723451",    #户口类型
    "residence_address": "新春一街12号",  #户口地址
    "parentinfo":[
	     {
	      "parent_name":"张强",         #家长姓名
	      "phone":"15235256525",
	      "email":"1523@.com",
	      "work_unit":"咚咚咚某某公司",       #工作单位
	      "position":"工程师",              #职位
	      "role":"1",                       #家长角色（1-爸爸;2-妈妈;3-爷爷;4-奶奶;5-其他）
	      "is_default":"1"                  #是否为主家长（0-否；1-是；）
	     },
	     {
	      "parent_name":"张强"，
	      "phone":"15235256525",
	      "email":"15223@.com",
	      "work_unit":"张强",
	      "position":"工程师",
	      "role":"1",              #家长角色（1-爸爸;2-妈妈;3-爷爷;4-奶奶;5-其他）
	      "is_default":"0"         #是否为主家长（0-否；1-是；）
	     }
  ]
}
Response:
    - `status`： 0->OK
			    1->班级不存在
                2->该手机号或邮箱已存
                10->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use nterface
```

> **返回结果示例：**

``` json
{
    "status": "0",
    "info": "OK"
}
```
####4.3.6 班级学生(家长)删除接口

> 需要使用Token验证查询者身份
``` json
Url:        /qxy/class/student
Method:     DELETE
Header:     Content-type:application/json
Parameter:
    - `cid`:         班级id
    - `student_id`： 学生id
    - 'token'：      token
    - 详见示例
示例：
{
    "token":"fcc277636dea80d3d298df9465795a875e6eb9df",
    "cid":"234",
    "student_id": "111"             #学生id
}
Response:
    - `status`： 0->OK
			    1->班级不存在
                2->该学生不存在
                10->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use nterface
```

> **返回结果示例：**

``` json
{
    "status": "0",
    "info": "OK"
}
```
### 4.4 学生管理
####4.4.1 学校学期年级班级查询接口（通用）
>9 系统设置
>9.3 班级设定页面接口
>9.3.1学校学期年级班级查询接口（通用）

####4.4.2 学生(家长)列表查询接口
> 查询学生列表，显示家长学生关联表中is_default为1的家长

> 需要使用Token验证查询者身份

``` json
Url:        /qxy/stundent/list/term=[term_id]&grade=[grade_id]&class=[cid]&page=[page]&size=[size]&teacher=[tid]&token=[token]
Method:     GET
Header:     Content-type:application/json
Parameter:
    - `term`:   学期id
    - `grade`:  年级id
    - `class`:    班级id
    - `page`:   分页编号，分页为0或者空时，返回全部数据
    - `size`:   每页数据条数，为0或空时，默认返回12条数据
    - `teacher`: 查询某教工下的班级学生，不传或为空时默认查看所有学生
Response:
    - `status`：0->token is OK 
                11->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use interface
    - `student`: 学生内容JSON
    - `count`:   学生总数
```

> **返回结果示例：**

``` json
{
    "status": 0,
    "data":{
        "page":"1",
        "size":"12",
        "count":"200",
        "student":[
              {   
                  "student_id": "3434",
                  "student_name": "张高丽",          #学生名字
                  "number": "234324242",         #学号
                  "term_name":"2015-2016-1",
			      "grade_name":"高三",
	              "class_name":"一班",
                  "phone": "13415235254",        #手机号
                  "parent_id": "12",           
                  "parent_name": "张强",            #家长姓名
                  "is_use":"1"                  #0-停用；1-启用
              },
              {   
                  "student_id": "3434",
                  "student_name": "张高丽",          #学生名字
                  "number": "234324242",         #学号
                  "term_name":"2015-2016-1",
			      "grade_name":"高三",
	              "class_name":"一班",
                  "phone": "13415235254",        #手机号
                  "parent_id": "12",           
                  "parent_name": "张强",            #家长姓名
                  "is_use":"1"                  #0-停用；1-启用
              }
            ]
        
    }
}
```

####4.4.3 学生(家长)搜索接口

> 需要使用Token验证查询者身份

``` json
Url:        /qxy/stundent/search/term=[term]&grade=[grade]&class=[cid]&number=[number]&teacher=[tid]&token=[token]
Method:     GET
Header:     Content-type:application/json
Parameter:
    - `term`:   学期id
    - `grade`:  年级id
    - `class`:    班级id
    - `number`: 学生学号
    - `teacher`:    教师id,可获取特定教师的班级学生
Response:
    - `status`：0->token is OK 
                11->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use interface
    - `student`: 学生内容JSON

```

> **返回结果示例：**

``` json
{
    "status": 0,
    "data":{
        "number": "234324242",
        "student":[
              {   
                  "student_id": "3434",
                  "student_name": "张高丽",          #学生名字
                  "number": "234324242",         #学号
                  "term_name":"2015-2016-1",
			      "grade_name":"高三",
	              "class_name":"一班",
                  "phone": "13415235254",        #手机号
                  "parent_id": "12",           
                  "parent_name": "张强",            #家长姓名
                  "is_use":"1"                  #0-停用；1-启用
              }
            ]
        
    }
}
```
####4.4.4 学生(家长)信息查询接口
> 学生信息详情查询接口返回当时学期的特定学生详情数据

> 班级学生查询接口需要使用Token验证查询者身份

``` json
Url:        /qxy/student/info/term=[term]&grade=[grade]&class=[cid]&student=[student_id]&teacher=[tid]&token=[token]
Method:     GET
Header:     Content-type:application/json
Parameter:
    - `term`:   学期id
    - `grade`:  年级id
    - `class`:    班级id
    - `student`:  学生id
    - `teacher`:    教师id,可获取特定教师的班级学生
Response:
    - `status`：       0->token is OK 
                       1->无效的student_id
                       11->token is invalid
                       12->token is timeout
                       13->Illegal interface calls, not power use interface
    - `parentinfo`:    学生家长内容JSON
```

> **返回结果示例：**

``` json
{
    "status": 0,
    "data":{
        "student_id": "3434",
        "student_name": "张高丽",              #学生姓名
        "date_of_birth": "1465228800",     #出生日期
        "student_type": "分配",             #学生类别
        "number": "1465228800",             #学号
        "date_of_school": "234324242",      #入学日期
        "residence_type": "13987723451",    #户口类型
        "residence_address": "新春一街12号",  #户口地址
        "parentinfo":[
	        {
		        "parent_id":"123",
		        "parent_name":"张强"，         #家长姓名
		        "phone":"15235256525"，
		        "email":"1523@.com"，
		        "work_unit":"咚咚咚某某公司"，       #工作单位
		        "position":"工程师"，      #职位
		        "is_use":"1",            #是否启用（0-停用；1-正常；）
		        "role":"1",              #家长角色（1-爸爸;2-妈妈;3-爷爷;4-奶奶;5-其他）
		        "is_default":"1"        #是否为主家长（0-否；1-是；）
	        },
	        {
		        "parent_id":"123",
		        "parent_name":"张强"，
		        "phone":"15235256525"，
		        "email":"15223@.com"，
		        "work_unit":"张强"，
		        "position":"工程师"，
		        "is_use":"1",            #是否启用（0-停用；1-正常；）
		        "role":"1",              #家长角色（1-爸爸;2-妈妈;3-爷爷;4-奶奶;5-其他）
		        "is_default":"1"        #是否为主家长（0-否；1-是；）
	        }
        ]
        
    }
}
```

####4.4.5 学生(家长)新增接口
引用班级学生中班级学生(家长)新增接口

####4.4.6 学生(家长)修改接口
引用班级学生中班级学生(家长)修改接口

####4.4.7 学生(家长)删除接口
引用班级学生中班级学生(家长)删除接口

####4.4.8 学生(家长)转班接口


> 需要使用Token验证查询者身份
``` json
Url:        /qxy/student/move
Method:     PUT
Header:     Content-type:application/json
Parameter:
    - `cid`:         班级id
    - `student_id`： 学生id
    - 'token'：      token
    - `target`:      目标班级id
示例：
{
    "token":"fcc277636dea80d3d298df9465795a875e6eb9df",
    "cid":"234",
    "student_id": "111"             #学生id
    "target":"234",
}
Response:
    - `status`： 0->OK
			    1->班级不存在
                2->该学生不存在
                10->token is invalid
                12->token is timeout
                13->Illegal interface calls, not power use nterface
```

> **返回结果示例：**

``` json
{
    "status": "0",
    "info": "OK"
}
```

